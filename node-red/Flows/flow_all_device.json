[
    {
        "id": "1ee5bb7aac8e1385",
        "type": "tab",
        "label": "Device01",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "ed61df0258281fd9",
        "type": "tab",
        "label": "Device02",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "70e8f775db7b11cd",
        "type": "tab",
        "label": "Device03",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "2b0ccb33173561a2",
        "type": "tab",
        "label": "Device04",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "ca64878d00b0b8d5",
        "type": "tab",
        "label": "Device05",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "ce876ccd83b6b630",
        "type": "tab",
        "label": "Device06",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "e3034ee0d241dc1b",
        "type": "tab",
        "label": "Device07",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "aadb65a7e9f1b8ac",
        "type": "tab",
        "label": "Device08",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "c061406022c51c80",
        "type": "tab",
        "label": "Device09",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "7fbf436e8b8bf7c4",
        "type": "tab",
        "label": "Device10",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "bb7bae07f6b14a98",
        "type": "tab",
        "label": "Device11",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "c1189ac503fd8176",
        "type": "tab",
        "label": "Device12",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "510d32737425765f",
        "type": "mqtt-broker",
        "name": "mqtt-client-device02",
        "broker": "10.33.33.10",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "07009369618d72bc",
        "type": "mqtt-broker",
        "name": "mqtt-client-device01",
        "broker": "10.33.33.10",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "9262d2ac65dcc7f3",
        "type": "mqtt-broker",
        "name": "mqtt-client-device03",
        "broker": "10.33.33.10",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "332963a58fb0bacf",
        "type": "mqtt-broker",
        "name": "mqtt-client-device04",
        "broker": "10.33.33.10",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "f0c9616a1a5e025a",
        "type": "mqtt-broker",
        "name": "mqtt-client-device05",
        "broker": "10.33.33.10",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "441c3139bc58fc6a",
        "type": "mqtt-broker",
        "name": "mqtt-client-device06",
        "broker": "10.33.33.10",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "77c5c034f7bd679b",
        "type": "mqtt-broker",
        "name": "mqtt-client-device07",
        "broker": "10.33.33.20",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "1f978df55ca59983",
        "type": "mqtt-broker",
        "name": "mqtt-client-device08",
        "broker": "10.33.33.20",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "d40ff6db4d15f74d",
        "type": "mqtt-broker",
        "name": "mqtt-client-device09",
        "broker": "10.33.33.20",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "9e32057440292cde",
        "type": "mqtt-broker",
        "name": "mqtt-client-device10",
        "broker": "10.33.33.20",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "279bdbbbd604db3a",
        "type": "mqtt-broker",
        "name": "mqtt-client-device11",
        "broker": "10.33.33.20",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "0027efa220a1b943",
        "type": "mqtt-broker",
        "name": "mqtt-client-device12",
        "broker": "10.33.33.20",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "280a43e18ce92a97",
        "type": "debug",
        "z": "1ee5bb7aac8e1385",
        "name": "Payload - device 01",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1770,
        "y": 340,
        "wires": []
    },
    {
        "id": "06a6a0569f64d31f",
        "type": "file in",
        "z": "1ee5bb7aac8e1385",
        "name": "MP10",
        "filename": "/var/snap/node-red/common/data/device_01/cetesb_osasco_mp10_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 530,
        "y": 120,
        "wires": [
            [
                "486aad5513939b40"
            ]
        ]
    },
    {
        "id": "9a8fe2f7e690c854",
        "type": "file in",
        "z": "1ee5bb7aac8e1385",
        "name": "MP2.5",
        "filename": "/var/snap/node-red/common/data/device_01/cetesb_osasco_mp25_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 530,
        "y": 200,
        "wires": [
            [
                "db49107aa4694aa3"
            ]
        ]
    },
    {
        "id": "36d76b6fe6ef6b95",
        "type": "file in",
        "z": "1ee5bb7aac8e1385",
        "name": "O3",
        "filename": "/var/snap/node-red/common/data/device_01/cetesb_carapicuiba_o3_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 530,
        "y": 280,
        "wires": [
            [
                "7cab8c714236c798"
            ]
        ]
    },
    {
        "id": "486aad5513939b40",
        "type": "json",
        "z": "1ee5bb7aac8e1385",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 120,
        "wires": [
            [
                "384b4d8d193e5402"
            ]
        ]
    },
    {
        "id": "384b4d8d193e5402",
        "type": "split",
        "z": "1ee5bb7aac8e1385",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1010,
        "y": 120,
        "wires": [
            [
                "52283f1c027ea6e3"
            ]
        ]
    },
    {
        "id": "52283f1c027ea6e3",
        "type": "delay",
        "z": "1ee5bb7aac8e1385",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 120,
        "wires": [
            [
                "3f0d74f6a107fead"
            ]
        ]
    },
    {
        "id": "db49107aa4694aa3",
        "type": "json",
        "z": "1ee5bb7aac8e1385",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 200,
        "wires": [
            [
                "3bc25accd9d3e7e5"
            ]
        ]
    },
    {
        "id": "3bc25accd9d3e7e5",
        "type": "split",
        "z": "1ee5bb7aac8e1385",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1000,
        "y": 200,
        "wires": [
            [
                "ec5467bdbdf396d7"
            ]
        ]
    },
    {
        "id": "ec5467bdbdf396d7",
        "type": "delay",
        "z": "1ee5bb7aac8e1385",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 200,
        "wires": [
            [
                "3f0d74f6a107fead"
            ]
        ]
    },
    {
        "id": "7cab8c714236c798",
        "type": "json",
        "z": "1ee5bb7aac8e1385",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 280,
        "wires": [
            [
                "ec243b70db9739d5"
            ]
        ]
    },
    {
        "id": "ec243b70db9739d5",
        "type": "split",
        "z": "1ee5bb7aac8e1385",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1000,
        "y": 280,
        "wires": [
            [
                "2f227d997c582441"
            ]
        ]
    },
    {
        "id": "2f227d997c582441",
        "type": "delay",
        "z": "1ee5bb7aac8e1385",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 280,
        "wires": [
            [
                "3f0d74f6a107fead"
            ]
        ]
    },
    {
        "id": "de46d52c41b897e8",
        "type": "file in",
        "z": "1ee5bb7aac8e1385",
        "name": "NO2",
        "filename": "/var/snap/node-red/common/data/device_01/cetesb_osasco_no2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 530,
        "y": 360,
        "wires": [
            [
                "91f5d0295659f2bd"
            ]
        ]
    },
    {
        "id": "242c48d80befc7bc",
        "type": "file in",
        "z": "1ee5bb7aac8e1385",
        "name": "SO2",
        "filename": "/var/snap/node-red/common/data/device_01/cetesb_osasco_so2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 530,
        "y": 440,
        "wires": [
            [
                "e1708e71f2943db7"
            ]
        ]
    },
    {
        "id": "984eb2d829167d6d",
        "type": "file in",
        "z": "1ee5bb7aac8e1385",
        "name": "CO",
        "filename": "/var/snap/node-red/common/data/device_01/cetesb_osasco_co_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 530,
        "y": 520,
        "wires": [
            [
                "66e3a8de249eaf33"
            ]
        ]
    },
    {
        "id": "30c013c4309d1a94",
        "type": "file in",
        "z": "1ee5bb7aac8e1385",
        "name": "Temperatura",
        "filename": "/var/snap/node-red/common/data/device_01/cetesb_carapicuiba_temperature_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 550,
        "y": 600,
        "wires": [
            [
                "e19e7e3dd2e9ee71"
            ]
        ]
    },
    {
        "id": "b86f051afcd241ac",
        "type": "file in",
        "z": "1ee5bb7aac8e1385",
        "name": "Umidade do Ar",
        "filename": "/var/snap/node-red/common/data/device_01/cetesb_carapicuiba_humidity_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 560,
        "y": 680,
        "wires": [
            [
                "a329fffdb88c8e78"
            ]
        ]
    },
    {
        "id": "cb4dc4d9401aa2a9",
        "type": "file in",
        "z": "1ee5bb7aac8e1385",
        "name": "Pressão",
        "filename": "/var/snap/node-red/common/data/device_01/cetesb_carapicuiba_pressure_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 540,
        "y": 760,
        "wires": [
            [
                "0bac86447422979a"
            ]
        ]
    },
    {
        "id": "3f0d74f6a107fead",
        "type": "function",
        "z": "1ee5bb7aac8e1385",
        "name": "Device01",
        "func": "// ===== Metadados estáticos do dispositivo =====\nconst DEVICE_META = {\n    deviceId: \"Device01\", // ID único do dispositivo\n    station: \"UFRN - IMD\", // Nome da estação\n    lat: -5.832163707456627, // Latitude e Longitude do dispositivo\n    lon: -35.2053595578561,   // cuidado com espaços antes do número!\n    model: \"Node-RED\", // Modelo do dispositivo\n    fw_version: \"v3.1.0\" // Versão do firmware\n};\n\n// ===== Mapeamento nomes reais -> padronizados =====\nconst mapSensor = {\n    \"mp10\": \"pm10\",\n    \"mp2\": \"pm25\",\n    \"o3\": \"o3\",\n    \"no2\": \"no2\",\n    \"so2\": \"so2\",\n    \"co\": \"co\",\n    \"temp\": \"temperatura\",\n    \"ur\": \"umidade\",\n    \"press\": \"pressao\"\n};\n\nconst sensoresEsperados = Object.values(mapSensor);\n\n// Buffer por timestamp no flow context\nlet buffer = flow.get(\"sensorBuffer\") || {};\n\nconst dado = msg.payload;\nconst ts = dado.timestamp;                // ISO8601/epoch conforme sua entrada\nconst nomeSensor = mapSensor[dado.sensor];\n\nif (!nomeSensor) return null; // ignora sensores desconhecidos\n\n// Cria bucket do timestamp se necessário\nif (!buffer[ts]) buffer[ts] = {};\n\n// Armazena valor padronizado\nbuffer[ts][nomeSensor] = dado.valor;\nflow.set(\"sensorBuffer\", buffer);\n\n// Verifica se todos os sensores chegaram\nconst sensoresPresentes = Object.keys(buffer[ts]);\nconst todosPresentes = sensoresEsperados.every(s => sensoresPresentes.includes(s));\n\nif (todosPresentes) {\n    // Payload final: metadados + geolocalização + timestamp + leituras\n    const payloadFinal = {\n        // --- metadados (topo) ---\n        deviceId: DEVICE_META.deviceId,\n        station: DEVICE_META.station,\n        lat: Number(DEVICE_META.lat),\n        lon: Number(DEVICE_META.lon),\n        model: DEVICE_META.model,\n        fw_version: DEVICE_META.fw_version,\n        // --- tempo ---\n        timestamp: ts\n    };\n\n    // Leituras (flatten para facilitar consumo / Grafana)\n    sensoresEsperados.forEach(s => {\n        payloadFinal[s] = buffer[ts][s] ?? null;\n    });\n\n    // Limpa o bucket do timestamp\n    delete buffer[ts];\n    flow.set(\"sensorBuffer\", buffer);\n    \n    // Playload pronto para envio\n    msg.payload = payloadFinal;\n    msg.qos = 1;        // opcional\n    msg.retain = false;    // telemetria normalmente não é retida\n    return msg;\n}\n\n// Ainda aguardando outros sensores desse timestamp\nreturn null;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "// Code added here will be run once\n// whenever the node is started.\nflow.set(\"index\", 0);\nflow.set(\"buffers\", {});\n\n",
        "finalize": "",
        "libs": [],
        "x": 1540,
        "y": 440,
        "wires": [
            [
                "f08de3e128808e37",
                "280a43e18ce92a97"
            ]
        ]
    },
    {
        "id": "f08de3e128808e37",
        "type": "mqtt out",
        "z": "1ee5bb7aac8e1385",
        "name": "MQTT Client - Publish Telemetria",
        "topic": "airq/devices/device01/telemetria",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "07009369618d72bc",
        "x": 1820,
        "y": 440,
        "wires": []
    },
    {
        "id": "85864d4d2aa1ba39",
        "type": "inject",
        "z": "1ee5bb7aac8e1385",
        "name": "Iniciar simulação",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 230,
        "y": 440,
        "wires": [
            [
                "de46d52c41b897e8",
                "242c48d80befc7bc",
                "984eb2d829167d6d",
                "30c013c4309d1a94",
                "b86f051afcd241ac",
                "cb4dc4d9401aa2a9",
                "06a6a0569f64d31f",
                "9a8fe2f7e690c854",
                "36d76b6fe6ef6b95"
            ]
        ]
    },
    {
        "id": "91f5d0295659f2bd",
        "type": "json",
        "z": "1ee5bb7aac8e1385",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 360,
        "wires": [
            [
                "ad9cc6defaf91bf2"
            ]
        ]
    },
    {
        "id": "ad9cc6defaf91bf2",
        "type": "split",
        "z": "1ee5bb7aac8e1385",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1000,
        "y": 360,
        "wires": [
            [
                "a5ac462ebda6a5a0"
            ]
        ]
    },
    {
        "id": "a5ac462ebda6a5a0",
        "type": "delay",
        "z": "1ee5bb7aac8e1385",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 360,
        "wires": [
            [
                "3f0d74f6a107fead"
            ]
        ]
    },
    {
        "id": "e1708e71f2943db7",
        "type": "json",
        "z": "1ee5bb7aac8e1385",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 440,
        "wires": [
            [
                "88bf6ec378598577"
            ]
        ]
    },
    {
        "id": "88bf6ec378598577",
        "type": "split",
        "z": "1ee5bb7aac8e1385",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1000,
        "y": 440,
        "wires": [
            [
                "2b1584bcaf1a1c49"
            ]
        ]
    },
    {
        "id": "2b1584bcaf1a1c49",
        "type": "delay",
        "z": "1ee5bb7aac8e1385",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 440,
        "wires": [
            [
                "3f0d74f6a107fead"
            ]
        ]
    },
    {
        "id": "66e3a8de249eaf33",
        "type": "json",
        "z": "1ee5bb7aac8e1385",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 520,
        "wires": [
            [
                "5a1e68c61e8ad831"
            ]
        ]
    },
    {
        "id": "5a1e68c61e8ad831",
        "type": "split",
        "z": "1ee5bb7aac8e1385",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1000,
        "y": 520,
        "wires": [
            [
                "655f793b6132272f"
            ]
        ]
    },
    {
        "id": "655f793b6132272f",
        "type": "delay",
        "z": "1ee5bb7aac8e1385",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 520,
        "wires": [
            [
                "3f0d74f6a107fead"
            ]
        ]
    },
    {
        "id": "e19e7e3dd2e9ee71",
        "type": "json",
        "z": "1ee5bb7aac8e1385",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 600,
        "wires": [
            [
                "85c506bd5e2f429d"
            ]
        ]
    },
    {
        "id": "85c506bd5e2f429d",
        "type": "split",
        "z": "1ee5bb7aac8e1385",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1020,
        "y": 600,
        "wires": [
            [
                "e3bd4adc8371caf5"
            ]
        ]
    },
    {
        "id": "e3bd4adc8371caf5",
        "type": "delay",
        "z": "1ee5bb7aac8e1385",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 600,
        "wires": [
            [
                "3f0d74f6a107fead"
            ]
        ]
    },
    {
        "id": "a329fffdb88c8e78",
        "type": "json",
        "z": "1ee5bb7aac8e1385",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 680,
        "wires": [
            [
                "01e821cf76856e12"
            ]
        ]
    },
    {
        "id": "01e821cf76856e12",
        "type": "split",
        "z": "1ee5bb7aac8e1385",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1020,
        "y": 680,
        "wires": [
            [
                "3508ca4184c3158c"
            ]
        ]
    },
    {
        "id": "3508ca4184c3158c",
        "type": "delay",
        "z": "1ee5bb7aac8e1385",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 680,
        "wires": [
            [
                "3f0d74f6a107fead"
            ]
        ]
    },
    {
        "id": "0bac86447422979a",
        "type": "json",
        "z": "1ee5bb7aac8e1385",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 760,
        "wires": [
            [
                "9816830560fbeb82"
            ]
        ]
    },
    {
        "id": "9816830560fbeb82",
        "type": "split",
        "z": "1ee5bb7aac8e1385",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1020,
        "y": 760,
        "wires": [
            [
                "5ea91176df4aec3e"
            ]
        ]
    },
    {
        "id": "5ea91176df4aec3e",
        "type": "delay",
        "z": "1ee5bb7aac8e1385",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 760,
        "wires": [
            [
                "3f0d74f6a107fead"
            ]
        ]
    },
    {
        "id": "1d230b5df2539322",
        "type": "file in",
        "z": "ed61df0258281fd9",
        "name": "MP10",
        "filename": "/var/snap/node-red/common/data/device_02/cetesb_marg-tiete_mp10_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 590,
        "y": 140,
        "wires": [
            [
                "50700b9e236ec8c2"
            ]
        ]
    },
    {
        "id": "286a746137b63e03",
        "type": "file in",
        "z": "ed61df0258281fd9",
        "name": "MP2.5",
        "filename": "/var/snap/node-red/common/data/device_02/cetesb_marg-tiete_mp25_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 590,
        "y": 220,
        "wires": [
            [
                "0b3e56ea5787b8ea"
            ]
        ]
    },
    {
        "id": "0fe18c4254da6a70",
        "type": "file in",
        "z": "ed61df0258281fd9",
        "name": "O3",
        "filename": "/var/snap/node-red/common/data/device_02/cetesb_pinheiros_o3_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 590,
        "y": 300,
        "wires": [
            [
                "4a94ccb4ff817d7a"
            ]
        ]
    },
    {
        "id": "3ae44e467a49ca2f",
        "type": "file in",
        "z": "ed61df0258281fd9",
        "name": "NO2",
        "filename": "/var/snap/node-red/common/data/device_02/cetesb_marg-tiete_no2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 590,
        "y": 380,
        "wires": [
            [
                "365b7c9bc5e9798b"
            ]
        ]
    },
    {
        "id": "25ae2244aba45d10",
        "type": "file in",
        "z": "ed61df0258281fd9",
        "name": "SO2",
        "filename": "/var/snap/node-red/common/data/device_02/cetesb_marg-tiete_so2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 590,
        "y": 460,
        "wires": [
            [
                "2e6106b72f97f909"
            ]
        ]
    },
    {
        "id": "8982f90b3996b5dc",
        "type": "file in",
        "z": "ed61df0258281fd9",
        "name": "CO",
        "filename": "/var/snap/node-red/common/data/device_02/cetesb_marg-tiete_co_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 590,
        "y": 540,
        "wires": [
            [
                "9ec388eab22f24d2"
            ]
        ]
    },
    {
        "id": "423f787fce82fb12",
        "type": "file in",
        "z": "ed61df0258281fd9",
        "name": "Temperatura",
        "filename": "/var/snap/node-red/common/data/device_02/cetesb_marg-tiete_temperature_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 610,
        "y": 620,
        "wires": [
            [
                "2e1d146835ed4482"
            ]
        ]
    },
    {
        "id": "878967d33436d0c6",
        "type": "file in",
        "z": "ed61df0258281fd9",
        "name": "Umidade do Ar",
        "filename": "/var/snap/node-red/common/data/device_02/cetesb_marg-tiete_humidity_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 620,
        "y": 700,
        "wires": [
            [
                "3bce58dcefd6ad58"
            ]
        ]
    },
    {
        "id": "2da2751926e8b533",
        "type": "file in",
        "z": "ed61df0258281fd9",
        "name": "Pressão",
        "filename": "/var/snap/node-red/common/data/device_02/cetesb_marg-tiete_pressure_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 600,
        "y": 780,
        "wires": [
            [
                "aa3931b91b280317"
            ]
        ]
    },
    {
        "id": "450a6bc4aff07d3d",
        "type": "function",
        "z": "ed61df0258281fd9",
        "name": "Device02",
        "func": "// ===== Metadados estáticos do dispositivo =====\nconst DEVICE_META = {\n    deviceId: \"Device02\", // ID único do dispositivo\n    station: \"IFRN\", // Nome da estação\n    lat: -5.8125393763550575, // Latitude e Longitude do dispositivo\n    lon: -35.20291139119372,   // cuidado com espaços antes do número!\n    model: \"Node-RED\", // Modelo do dispositivo\n    fw_version: \"v3.1.0\" // Versão do firmware\n};\n\n// ===== Mapeamento nomes reais -> padronizados =====\nconst mapSensor = {\n    \"mp10\": \"pm10\",\n    \"mp2\": \"pm25\",\n    \"o3\": \"o3\",\n    \"no2\": \"no2\",\n    \"so2\": \"so2\",\n    \"co\": \"co\",\n    \"temp\": \"temperatura\",\n    \"ur\": \"umidade\",\n    \"press\": \"pressao\"\n};\n\nconst sensoresEsperados = Object.values(mapSensor);\n\n// Buffer por timestamp no flow context\nlet buffer = flow.get(\"sensorBuffer\") || {};\n\nconst dado = msg.payload;\nconst ts = dado.timestamp;                // ISO8601/epoch conforme sua entrada\nconst nomeSensor = mapSensor[dado.sensor];\n\nif (!nomeSensor) return null; // ignora sensores desconhecidos\n\n// Cria bucket do timestamp se necessário\nif (!buffer[ts]) buffer[ts] = {};\n\n// Armazena valor padronizado\nbuffer[ts][nomeSensor] = dado.valor;\nflow.set(\"sensorBuffer\", buffer);\n\n// Verifica se todos os sensores chegaram\nconst sensoresPresentes = Object.keys(buffer[ts]);\nconst todosPresentes = sensoresEsperados.every(s => sensoresPresentes.includes(s));\n\nif (todosPresentes) {\n    // Payload final: metadados + geolocalização + timestamp + leituras\n    const payloadFinal = {\n        // --- metadados (topo) ---\n        deviceId: DEVICE_META.deviceId,\n        station: DEVICE_META.station,\n        lat: Number(DEVICE_META.lat),\n        lon: Number(DEVICE_META.lon),\n        model: DEVICE_META.model,\n        fw_version: DEVICE_META.fw_version,\n        // --- tempo ---\n        timestamp: ts\n    };\n\n    // Leituras (flatten para facilitar consumo / Grafana)\n    sensoresEsperados.forEach(s => {\n        payloadFinal[s] = buffer[ts][s] ?? null;\n    });\n\n    // Limpa o bucket do timestamp\n    delete buffer[ts];\n    flow.set(\"sensorBuffer\", buffer);\n\n    // Playload pronto para envio\n    msg.payload = payloadFinal;\n    msg.qos = 1;        // opcional\n    msg.retain = false;    // telemetria normalmente não é retida\n    return msg;\n}\n\n// Ainda aguardando outros sensores desse timestamp\nreturn null;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "// Code added here will be run once\n// whenever the node is started.\nflow.set(\"index\", 0);\nflow.set(\"buffers\", {});\n\n",
        "finalize": "",
        "libs": [],
        "x": 1600,
        "y": 460,
        "wires": [
            [
                "219024eae1f84586",
                "acc735c2573998f1"
            ]
        ]
    },
    {
        "id": "219024eae1f84586",
        "type": "mqtt out",
        "z": "ed61df0258281fd9",
        "name": "MQTT Client - Publish Telemetria",
        "topic": "airq/devices/device02/telemetria",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "510d32737425765f",
        "x": 1880,
        "y": 460,
        "wires": []
    },
    {
        "id": "50700b9e236ec8c2",
        "type": "json",
        "z": "ed61df0258281fd9",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 850,
        "y": 140,
        "wires": [
            [
                "1e678d386c0bc897"
            ]
        ]
    },
    {
        "id": "1e678d386c0bc897",
        "type": "split",
        "z": "ed61df0258281fd9",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1070,
        "y": 140,
        "wires": [
            [
                "f55c7bc9a5593eee"
            ]
        ]
    },
    {
        "id": "f55c7bc9a5593eee",
        "type": "delay",
        "z": "ed61df0258281fd9",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1310,
        "y": 140,
        "wires": [
            [
                "450a6bc4aff07d3d"
            ]
        ]
    },
    {
        "id": "3a862d52b1da0023",
        "type": "inject",
        "z": "ed61df0258281fd9",
        "name": "Iniciar simulação",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 290,
        "y": 460,
        "wires": [
            [
                "1d230b5df2539322",
                "286a746137b63e03",
                "0fe18c4254da6a70",
                "3ae44e467a49ca2f",
                "25ae2244aba45d10",
                "8982f90b3996b5dc",
                "423f787fce82fb12",
                "878967d33436d0c6",
                "2da2751926e8b533"
            ]
        ]
    },
    {
        "id": "0b3e56ea5787b8ea",
        "type": "json",
        "z": "ed61df0258281fd9",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 850,
        "y": 220,
        "wires": [
            [
                "0a152fba5da1fe3b"
            ]
        ]
    },
    {
        "id": "0a152fba5da1fe3b",
        "type": "split",
        "z": "ed61df0258281fd9",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1060,
        "y": 220,
        "wires": [
            [
                "02bf46302ac1ca62"
            ]
        ]
    },
    {
        "id": "02bf46302ac1ca62",
        "type": "delay",
        "z": "ed61df0258281fd9",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1310,
        "y": 220,
        "wires": [
            [
                "450a6bc4aff07d3d"
            ]
        ]
    },
    {
        "id": "4a94ccb4ff817d7a",
        "type": "json",
        "z": "ed61df0258281fd9",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 850,
        "y": 300,
        "wires": [
            [
                "38037ccb6622698e"
            ]
        ]
    },
    {
        "id": "38037ccb6622698e",
        "type": "split",
        "z": "ed61df0258281fd9",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1060,
        "y": 300,
        "wires": [
            [
                "9a153d2cbda94ddb"
            ]
        ]
    },
    {
        "id": "9a153d2cbda94ddb",
        "type": "delay",
        "z": "ed61df0258281fd9",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1310,
        "y": 300,
        "wires": [
            [
                "450a6bc4aff07d3d"
            ]
        ]
    },
    {
        "id": "365b7c9bc5e9798b",
        "type": "json",
        "z": "ed61df0258281fd9",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 850,
        "y": 380,
        "wires": [
            [
                "8b58b0732635ccab"
            ]
        ]
    },
    {
        "id": "8b58b0732635ccab",
        "type": "split",
        "z": "ed61df0258281fd9",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1060,
        "y": 380,
        "wires": [
            [
                "0c40646339c276e4"
            ]
        ]
    },
    {
        "id": "0c40646339c276e4",
        "type": "delay",
        "z": "ed61df0258281fd9",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1310,
        "y": 380,
        "wires": [
            [
                "450a6bc4aff07d3d"
            ]
        ]
    },
    {
        "id": "2e6106b72f97f909",
        "type": "json",
        "z": "ed61df0258281fd9",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 850,
        "y": 460,
        "wires": [
            [
                "f533697d89255ae1"
            ]
        ]
    },
    {
        "id": "f533697d89255ae1",
        "type": "split",
        "z": "ed61df0258281fd9",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1060,
        "y": 460,
        "wires": [
            [
                "bb43d87020c596d3"
            ]
        ]
    },
    {
        "id": "bb43d87020c596d3",
        "type": "delay",
        "z": "ed61df0258281fd9",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1310,
        "y": 460,
        "wires": [
            [
                "450a6bc4aff07d3d"
            ]
        ]
    },
    {
        "id": "9ec388eab22f24d2",
        "type": "json",
        "z": "ed61df0258281fd9",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 850,
        "y": 540,
        "wires": [
            [
                "39b9aafdd1e10e49"
            ]
        ]
    },
    {
        "id": "39b9aafdd1e10e49",
        "type": "split",
        "z": "ed61df0258281fd9",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1060,
        "y": 540,
        "wires": [
            [
                "36ceb7c069ab801f"
            ]
        ]
    },
    {
        "id": "36ceb7c069ab801f",
        "type": "delay",
        "z": "ed61df0258281fd9",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1310,
        "y": 540,
        "wires": [
            [
                "450a6bc4aff07d3d"
            ]
        ]
    },
    {
        "id": "2e1d146835ed4482",
        "type": "json",
        "z": "ed61df0258281fd9",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 850,
        "y": 620,
        "wires": [
            [
                "d57419a6c76b4560"
            ]
        ]
    },
    {
        "id": "d57419a6c76b4560",
        "type": "split",
        "z": "ed61df0258281fd9",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1080,
        "y": 620,
        "wires": [
            [
                "8224f2513b439540"
            ]
        ]
    },
    {
        "id": "8224f2513b439540",
        "type": "delay",
        "z": "ed61df0258281fd9",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1310,
        "y": 620,
        "wires": [
            [
                "450a6bc4aff07d3d"
            ]
        ]
    },
    {
        "id": "3bce58dcefd6ad58",
        "type": "json",
        "z": "ed61df0258281fd9",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 850,
        "y": 700,
        "wires": [
            [
                "581e14ad03a54f85"
            ]
        ]
    },
    {
        "id": "581e14ad03a54f85",
        "type": "split",
        "z": "ed61df0258281fd9",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1080,
        "y": 700,
        "wires": [
            [
                "81dbcf5157868d55"
            ]
        ]
    },
    {
        "id": "81dbcf5157868d55",
        "type": "delay",
        "z": "ed61df0258281fd9",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1310,
        "y": 700,
        "wires": [
            [
                "450a6bc4aff07d3d"
            ]
        ]
    },
    {
        "id": "aa3931b91b280317",
        "type": "json",
        "z": "ed61df0258281fd9",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 850,
        "y": 780,
        "wires": [
            [
                "a5393e965d996420"
            ]
        ]
    },
    {
        "id": "a5393e965d996420",
        "type": "split",
        "z": "ed61df0258281fd9",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1080,
        "y": 780,
        "wires": [
            [
                "b0c7ac4c071b564c"
            ]
        ]
    },
    {
        "id": "b0c7ac4c071b564c",
        "type": "delay",
        "z": "ed61df0258281fd9",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1310,
        "y": 780,
        "wires": [
            [
                "450a6bc4aff07d3d"
            ]
        ]
    },
    {
        "id": "acc735c2573998f1",
        "type": "debug",
        "z": "ed61df0258281fd9",
        "d": true,
        "name": "Payload - device 02",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1830,
        "y": 360,
        "wires": []
    },
    {
        "id": "f597627e61a73528",
        "type": "file in",
        "z": "70e8f775db7b11cd",
        "name": "MP10",
        "filename": "/var/snap/node-red/common/data/device_03/cetesb_parque-dom-pedro_mp10_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 530,
        "y": 80,
        "wires": [
            [
                "5e36db26ceae4d69"
            ]
        ]
    },
    {
        "id": "7f1ef7ee334ef068",
        "type": "file in",
        "z": "70e8f775db7b11cd",
        "name": "MP2.5",
        "filename": "/var/snap/node-red/common/data/device_03/cetesb_parque-dom-pedro_mp25_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 530,
        "y": 160,
        "wires": [
            [
                "09fabae0ca10abed"
            ]
        ]
    },
    {
        "id": "c5b397d2d3d6bd2d",
        "type": "file in",
        "z": "70e8f775db7b11cd",
        "name": "O3",
        "filename": "/var/snap/node-red/common/data/device_03/cetesb_parque-dom-pedro_o3_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 530,
        "y": 240,
        "wires": [
            [
                "8c63f2ce05d8c643"
            ]
        ]
    },
    {
        "id": "6cf86fd9ec735e51",
        "type": "file in",
        "z": "70e8f775db7b11cd",
        "name": "NO2",
        "filename": "/var/snap/node-red/common/data/device_03/cetesb_parque-dom-pedro_no2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 530,
        "y": 320,
        "wires": [
            [
                "99558803d08d977c"
            ]
        ]
    },
    {
        "id": "e34e2d73b2968b20",
        "type": "file in",
        "z": "70e8f775db7b11cd",
        "name": "SO2",
        "filename": "/var/snap/node-red/common/data/device_03/cetesb_cerqueira_so2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 530,
        "y": 400,
        "wires": [
            [
                "c6b5f2bdbcc10ef9"
            ]
        ]
    },
    {
        "id": "8582fce370bfa249",
        "type": "file in",
        "z": "70e8f775db7b11cd",
        "name": "CO",
        "filename": "/var/snap/node-red/common/data/device_03/cetesb_parque-dom-pedro_co_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 530,
        "y": 480,
        "wires": [
            [
                "8fc2c662ccedf622"
            ]
        ]
    },
    {
        "id": "a300b6e7fcdaef16",
        "type": "file in",
        "z": "70e8f775db7b11cd",
        "name": "Temperatura",
        "filename": "/var/snap/node-red/common/data/device_03/cetesb_parque-dom-pedro_temperature_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 550,
        "y": 560,
        "wires": [
            [
                "272a22ccd78d2ede"
            ]
        ]
    },
    {
        "id": "3f4c9b8e77303b64",
        "type": "file in",
        "z": "70e8f775db7b11cd",
        "name": "Umidade do Ar",
        "filename": "/var/snap/node-red/common/data/device_03/cetesb_parque-dom-pedro_humidity_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 560,
        "y": 640,
        "wires": [
            [
                "7a76de447f200ba6"
            ]
        ]
    },
    {
        "id": "68b1fc6ae4bf7d87",
        "type": "file in",
        "z": "70e8f775db7b11cd",
        "name": "Pressão",
        "filename": "/var/snap/node-red/common/data/device_03/cetesb_parque-dom-pedro_pressure_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 540,
        "y": 720,
        "wires": [
            [
                "94b5cfbd817ab072"
            ]
        ]
    },
    {
        "id": "2707c99a22f8bf15",
        "type": "function",
        "z": "70e8f775db7b11cd",
        "name": "Device03",
        "func": "// ===== Metadados estáticos do dispositivo =====\nconst DEVICE_META = {\n    deviceId: \"Device03\", // ID único do dispositivo\n    station: \"Ponta Negra\", // Nome da estação\n    lat: -5.880163040096386, // Latitude e Longitude do dispositivo\n    lon: -35.172308682874814,   // cuidado com espaços antes do número!\n    model: \"Node-RED\", // Modelo do dispositivo\n    fw_version: \"v3.1.0\" // Versão do firmware\n};\n\n// ===== Mapeamento nomes reais -> padronizados =====\nconst mapSensor = {\n    \"mp10\": \"pm10\",\n    \"mp2\": \"pm25\",\n    \"o3\": \"o3\",\n    \"no2\": \"no2\",\n    \"so2\": \"so2\",\n    \"co\": \"co\",\n    \"temp\": \"temperatura\",\n    \"ur\": \"umidade\",\n    \"press\": \"pressao\"\n};\n\nconst sensoresEsperados = Object.values(mapSensor);\n\n// Buffer por timestamp no flow context\nlet buffer = flow.get(\"sensorBuffer\") || {};\n\nconst dado = msg.payload;\nconst ts = dado.timestamp;                // ISO8601/epoch conforme sua entrada\nconst nomeSensor = mapSensor[dado.sensor];\n\nif (!nomeSensor) return null; // ignora sensores desconhecidos\n\n// Cria bucket do timestamp se necessário\nif (!buffer[ts]) buffer[ts] = {};\n\n// Armazena valor padronizado\nbuffer[ts][nomeSensor] = dado.valor;\nflow.set(\"sensorBuffer\", buffer);\n\n// Verifica se todos os sensores chegaram\nconst sensoresPresentes = Object.keys(buffer[ts]);\nconst todosPresentes = sensoresEsperados.every(s => sensoresPresentes.includes(s));\n\nif (todosPresentes) {\n    // Payload final: metadados + geolocalização + timestamp + leituras\n    const payloadFinal = {\n        // --- metadados (topo) ---\n        deviceId: DEVICE_META.deviceId,\n        station: DEVICE_META.station,\n        lat: Number(DEVICE_META.lat),\n        lon: Number(DEVICE_META.lon),\n        model: DEVICE_META.model,\n        fw_version: DEVICE_META.fw_version,\n        // --- tempo ---\n        timestamp: ts\n    };\n\n    // Leituras (flatten para facilitar consumo / Grafana)\n    sensoresEsperados.forEach(s => {\n        payloadFinal[s] = buffer[ts][s] ?? null;\n    });\n\n    // Limpa o bucket do timestamp\n    delete buffer[ts];\n    flow.set(\"sensorBuffer\", buffer);\n\n    // Playload pronto para envio\n    msg.payload = payloadFinal;\n    msg.qos = 1;        // opcional\n    msg.retain = false;    // telemetria normalmente não é retida\n    return msg;\n}\n\n// Ainda aguardando outros sensores desse timestamp\nreturn null;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "// Code added here will be run once\n// whenever the node is started.\nflow.set(\"index\", 0);\nflow.set(\"buffers\", {});\n\n",
        "finalize": "",
        "libs": [],
        "x": 1540,
        "y": 400,
        "wires": [
            [
                "69822737a2b5f5c3",
                "f8dbc2fd7e15eb09"
            ]
        ]
    },
    {
        "id": "69822737a2b5f5c3",
        "type": "mqtt out",
        "z": "70e8f775db7b11cd",
        "name": "MQTT Client - Publish Telemetria",
        "topic": "airq/devices/device03/telemetria",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "9262d2ac65dcc7f3",
        "x": 1820,
        "y": 400,
        "wires": []
    },
    {
        "id": "5e36db26ceae4d69",
        "type": "json",
        "z": "70e8f775db7b11cd",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 80,
        "wires": [
            [
                "5bc3e3778a1ffe81"
            ]
        ]
    },
    {
        "id": "5bc3e3778a1ffe81",
        "type": "split",
        "z": "70e8f775db7b11cd",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1010,
        "y": 80,
        "wires": [
            [
                "eae40b959f697da4"
            ]
        ]
    },
    {
        "id": "eae40b959f697da4",
        "type": "delay",
        "z": "70e8f775db7b11cd",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 80,
        "wires": [
            [
                "2707c99a22f8bf15"
            ]
        ]
    },
    {
        "id": "81da8cf87eb7b486",
        "type": "inject",
        "z": "70e8f775db7b11cd",
        "name": "Iniciar simulação",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 230,
        "y": 400,
        "wires": [
            [
                "f597627e61a73528",
                "7f1ef7ee334ef068",
                "c5b397d2d3d6bd2d",
                "6cf86fd9ec735e51",
                "e34e2d73b2968b20",
                "8582fce370bfa249",
                "a300b6e7fcdaef16",
                "3f4c9b8e77303b64",
                "68b1fc6ae4bf7d87"
            ]
        ]
    },
    {
        "id": "09fabae0ca10abed",
        "type": "json",
        "z": "70e8f775db7b11cd",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 160,
        "wires": [
            [
                "7fc417fe1c52ad36"
            ]
        ]
    },
    {
        "id": "7fc417fe1c52ad36",
        "type": "split",
        "z": "70e8f775db7b11cd",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1000,
        "y": 160,
        "wires": [
            [
                "c32230db76daea48"
            ]
        ]
    },
    {
        "id": "c32230db76daea48",
        "type": "delay",
        "z": "70e8f775db7b11cd",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 160,
        "wires": [
            [
                "2707c99a22f8bf15"
            ]
        ]
    },
    {
        "id": "8c63f2ce05d8c643",
        "type": "json",
        "z": "70e8f775db7b11cd",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 240,
        "wires": [
            [
                "1928ebc2ec3bca70"
            ]
        ]
    },
    {
        "id": "1928ebc2ec3bca70",
        "type": "split",
        "z": "70e8f775db7b11cd",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1000,
        "y": 240,
        "wires": [
            [
                "51037b649d41680f"
            ]
        ]
    },
    {
        "id": "51037b649d41680f",
        "type": "delay",
        "z": "70e8f775db7b11cd",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 240,
        "wires": [
            [
                "2707c99a22f8bf15"
            ]
        ]
    },
    {
        "id": "99558803d08d977c",
        "type": "json",
        "z": "70e8f775db7b11cd",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 320,
        "wires": [
            [
                "440f5e81cd834bab"
            ]
        ]
    },
    {
        "id": "440f5e81cd834bab",
        "type": "split",
        "z": "70e8f775db7b11cd",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1000,
        "y": 320,
        "wires": [
            [
                "e93c8c390a109ac1"
            ]
        ]
    },
    {
        "id": "e93c8c390a109ac1",
        "type": "delay",
        "z": "70e8f775db7b11cd",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 320,
        "wires": [
            [
                "2707c99a22f8bf15"
            ]
        ]
    },
    {
        "id": "c6b5f2bdbcc10ef9",
        "type": "json",
        "z": "70e8f775db7b11cd",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 400,
        "wires": [
            [
                "c205425edf71946b"
            ]
        ]
    },
    {
        "id": "c205425edf71946b",
        "type": "split",
        "z": "70e8f775db7b11cd",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1000,
        "y": 400,
        "wires": [
            [
                "793fd9c71a6d3376"
            ]
        ]
    },
    {
        "id": "793fd9c71a6d3376",
        "type": "delay",
        "z": "70e8f775db7b11cd",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 400,
        "wires": [
            [
                "2707c99a22f8bf15"
            ]
        ]
    },
    {
        "id": "8fc2c662ccedf622",
        "type": "json",
        "z": "70e8f775db7b11cd",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 480,
        "wires": [
            [
                "ce85d3e80f8180e3"
            ]
        ]
    },
    {
        "id": "ce85d3e80f8180e3",
        "type": "split",
        "z": "70e8f775db7b11cd",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1000,
        "y": 480,
        "wires": [
            [
                "bf5bd6dc96476000"
            ]
        ]
    },
    {
        "id": "bf5bd6dc96476000",
        "type": "delay",
        "z": "70e8f775db7b11cd",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 480,
        "wires": [
            [
                "2707c99a22f8bf15"
            ]
        ]
    },
    {
        "id": "272a22ccd78d2ede",
        "type": "json",
        "z": "70e8f775db7b11cd",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 560,
        "wires": [
            [
                "6e183ac8296fa209"
            ]
        ]
    },
    {
        "id": "6e183ac8296fa209",
        "type": "split",
        "z": "70e8f775db7b11cd",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1020,
        "y": 560,
        "wires": [
            [
                "39cfb6229d57c18b"
            ]
        ]
    },
    {
        "id": "39cfb6229d57c18b",
        "type": "delay",
        "z": "70e8f775db7b11cd",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 560,
        "wires": [
            [
                "2707c99a22f8bf15"
            ]
        ]
    },
    {
        "id": "7a76de447f200ba6",
        "type": "json",
        "z": "70e8f775db7b11cd",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 640,
        "wires": [
            [
                "9f6de558f6a32cde"
            ]
        ]
    },
    {
        "id": "9f6de558f6a32cde",
        "type": "split",
        "z": "70e8f775db7b11cd",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1020,
        "y": 640,
        "wires": [
            [
                "750dc2d0e53444b9"
            ]
        ]
    },
    {
        "id": "750dc2d0e53444b9",
        "type": "delay",
        "z": "70e8f775db7b11cd",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 640,
        "wires": [
            [
                "2707c99a22f8bf15"
            ]
        ]
    },
    {
        "id": "94b5cfbd817ab072",
        "type": "json",
        "z": "70e8f775db7b11cd",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 720,
        "wires": [
            [
                "a796dd34834b5a70"
            ]
        ]
    },
    {
        "id": "a796dd34834b5a70",
        "type": "split",
        "z": "70e8f775db7b11cd",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1020,
        "y": 720,
        "wires": [
            [
                "680f782e5103c968"
            ]
        ]
    },
    {
        "id": "680f782e5103c968",
        "type": "delay",
        "z": "70e8f775db7b11cd",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 720,
        "wires": [
            [
                "2707c99a22f8bf15"
            ]
        ]
    },
    {
        "id": "f8dbc2fd7e15eb09",
        "type": "debug",
        "z": "70e8f775db7b11cd",
        "d": true,
        "name": "Payload - device 03",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1770,
        "y": 300,
        "wires": []
    },
    {
        "id": "7ac1f43df93f17e7",
        "type": "file in",
        "z": "2b0ccb33173561a2",
        "name": "MP10",
        "filename": "/var/snap/node-red/common/data/device_04/cetesb_congonhas_mp10_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 470,
        "y": 80,
        "wires": [
            [
                "f474bc7b06edfa3d"
            ]
        ]
    },
    {
        "id": "db94e31892d129b2",
        "type": "file in",
        "z": "2b0ccb33173561a2",
        "name": "MP2.5",
        "filename": "/var/snap/node-red/common/data/device_04/cetesb_interlagos_mp25_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 470,
        "y": 160,
        "wires": [
            [
                "10fba13e135f405c"
            ]
        ]
    },
    {
        "id": "339cdcff956b6447",
        "type": "file in",
        "z": "2b0ccb33173561a2",
        "name": "O3",
        "filename": "/var/snap/node-red/common/data/device_04/cetesb_santo-amaro_o3_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 470,
        "y": 240,
        "wires": [
            [
                "c2c1ce37c92f7438"
            ]
        ]
    },
    {
        "id": "93a6a6802276d44a",
        "type": "file in",
        "z": "2b0ccb33173561a2",
        "name": "NO2",
        "filename": "/var/snap/node-red/common/data/device_04/cetesb_congonhas_no2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 470,
        "y": 320,
        "wires": [
            [
                "a57d311e2c1a1a52"
            ]
        ]
    },
    {
        "id": "e0542b085abce2b9",
        "type": "file in",
        "z": "2b0ccb33173561a2",
        "name": "SO2",
        "filename": "/var/snap/node-red/common/data/device_04/cetesb_interlagos_so2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 470,
        "y": 400,
        "wires": [
            [
                "3af529fb75f424d1"
            ]
        ]
    },
    {
        "id": "42cbb3709a040bc5",
        "type": "file in",
        "z": "2b0ccb33173561a2",
        "name": "CO",
        "filename": "/var/snap/node-red/common/data/device_04/cetesb_santo-amaro_co_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 470,
        "y": 480,
        "wires": [
            [
                "ec1ca621389a378d"
            ]
        ]
    },
    {
        "id": "bdfa0c0326d17574",
        "type": "file in",
        "z": "2b0ccb33173561a2",
        "name": "Temperatura",
        "filename": "/var/snap/node-red/common/data/device_04/cetesb_interlagos_temperature_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 490,
        "y": 560,
        "wires": [
            [
                "2180cd4cf6956ad3"
            ]
        ]
    },
    {
        "id": "df595aaf6ff8a8c7",
        "type": "file in",
        "z": "2b0ccb33173561a2",
        "name": "Umidade do Ar",
        "filename": "/var/snap/node-red/common/data/device_04/cetesb_sao-bernado_humidity_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 500,
        "y": 640,
        "wires": [
            [
                "6d6626784a92beae"
            ]
        ]
    },
    {
        "id": "26f78a1c7e30e94e",
        "type": "file in",
        "z": "2b0ccb33173561a2",
        "name": "Pressão",
        "filename": "/var/snap/node-red/common/data/device_04/cetesb_sao-bernado_pressure_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 480,
        "y": 720,
        "wires": [
            [
                "f7a75f92da81415c"
            ]
        ]
    },
    {
        "id": "707f5bcb90838fe3",
        "type": "function",
        "z": "2b0ccb33173561a2",
        "name": "Device04",
        "func": "// ===== Metadados estáticos do dispositivo =====\nconst DEVICE_META = {\n    deviceId: \"Device04\", // ID único do dispositivo\n    station: \"UFRN - HUOL\", // Nome da estação\n    lat: -5.78049163257284, // Latitude e Longitude do dispositivo\n    lon: -35.19627357781805,   // cuidado com espaços antes do número!\n    model: \"Node-RED\", // Modelo do dispositivo\n    fw_version: \"v3.1.0\" // Versão do firmware\n};\n\n// ===== Mapeamento nomes reais -> padronizados =====\nconst mapSensor = {\n    \"mp10\": \"pm10\",\n    \"mp2\": \"pm25\",\n    \"o3\": \"o3\",\n    \"no2\": \"no2\",\n    \"so2\": \"so2\",\n    \"co\": \"co\",\n    \"temp\": \"temperatura\",\n    \"ur\": \"umidade\",\n    \"press\": \"pressao\"\n};\n\nconst sensoresEsperados = Object.values(mapSensor);\n\n// Buffer por timestamp no flow context\nlet buffer = flow.get(\"sensorBuffer\") || {};\n\nconst dado = msg.payload;\nconst ts = dado.timestamp;                // ISO8601/epoch conforme sua entrada\nconst nomeSensor = mapSensor[dado.sensor];\n\nif (!nomeSensor) return null; // ignora sensores desconhecidos\n\n// Cria bucket do timestamp se necessário\nif (!buffer[ts]) buffer[ts] = {};\n\n// Armazena valor padronizado\nbuffer[ts][nomeSensor] = dado.valor;\nflow.set(\"sensorBuffer\", buffer);\n\n// Verifica se todos os sensores chegaram\nconst sensoresPresentes = Object.keys(buffer[ts]);\nconst todosPresentes = sensoresEsperados.every(s => sensoresPresentes.includes(s));\n\nif (todosPresentes) {\n    // Payload final: metadados + geolocalização + timestamp + leituras\n    const payloadFinal = {\n        // --- metadados (topo) ---\n        deviceId: DEVICE_META.deviceId,\n        station: DEVICE_META.station,\n        lat: Number(DEVICE_META.lat),\n        lon: Number(DEVICE_META.lon),\n        model: DEVICE_META.model,\n        fw_version: DEVICE_META.fw_version,\n        // --- tempo ---\n        timestamp: ts\n    };\n\n    // Leituras (flatten para facilitar consumo / Grafana)\n    sensoresEsperados.forEach(s => {\n        payloadFinal[s] = buffer[ts][s] ?? null;\n    });\n\n    // Limpa o bucket do timestamp\n    delete buffer[ts];\n    flow.set(\"sensorBuffer\", buffer);\n\n    // Playload pronto para envio\n    msg.payload = payloadFinal;\n    msg.qos = 1;        // opcional\n    msg.retain = false;    // telemetria normalmente não é retida\n    return msg;\n}\n\n// Ainda aguardando outros sensores desse timestamp\nreturn null;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "// Code added here will be run once\n// whenever the node is started.\nflow.set(\"index\", 0);\nflow.set(\"buffers\", {});\n\n",
        "finalize": "",
        "libs": [],
        "x": 1480,
        "y": 400,
        "wires": [
            [
                "3919f4e93b3969cb",
                "2eaf9f6e245d74b5"
            ]
        ]
    },
    {
        "id": "3919f4e93b3969cb",
        "type": "mqtt out",
        "z": "2b0ccb33173561a2",
        "name": "MQTT Client - Publish Telemetria",
        "topic": "airq/devices/device04/telemetria",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "332963a58fb0bacf",
        "x": 1760,
        "y": 400,
        "wires": []
    },
    {
        "id": "f474bc7b06edfa3d",
        "type": "json",
        "z": "2b0ccb33173561a2",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 80,
        "wires": [
            [
                "0a157df372e1a9f8"
            ]
        ]
    },
    {
        "id": "0a157df372e1a9f8",
        "type": "split",
        "z": "2b0ccb33173561a2",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 950,
        "y": 80,
        "wires": [
            [
                "58fcfb7921bb593e"
            ]
        ]
    },
    {
        "id": "58fcfb7921bb593e",
        "type": "delay",
        "z": "2b0ccb33173561a2",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 80,
        "wires": [
            [
                "707f5bcb90838fe3"
            ]
        ]
    },
    {
        "id": "871c46060fb94911",
        "type": "inject",
        "z": "2b0ccb33173561a2",
        "name": "Iniciar simulação",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 170,
        "y": 400,
        "wires": [
            [
                "7ac1f43df93f17e7",
                "db94e31892d129b2",
                "339cdcff956b6447",
                "93a6a6802276d44a",
                "e0542b085abce2b9",
                "42cbb3709a040bc5",
                "bdfa0c0326d17574",
                "df595aaf6ff8a8c7",
                "26f78a1c7e30e94e"
            ]
        ]
    },
    {
        "id": "10fba13e135f405c",
        "type": "json",
        "z": "2b0ccb33173561a2",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 160,
        "wires": [
            [
                "47baa6ca64b88c2f"
            ]
        ]
    },
    {
        "id": "47baa6ca64b88c2f",
        "type": "split",
        "z": "2b0ccb33173561a2",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 940,
        "y": 160,
        "wires": [
            [
                "926e44d3544b8862"
            ]
        ]
    },
    {
        "id": "926e44d3544b8862",
        "type": "delay",
        "z": "2b0ccb33173561a2",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 160,
        "wires": [
            [
                "707f5bcb90838fe3"
            ]
        ]
    },
    {
        "id": "c2c1ce37c92f7438",
        "type": "json",
        "z": "2b0ccb33173561a2",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 240,
        "wires": [
            [
                "2a9e1222649aaf3a"
            ]
        ]
    },
    {
        "id": "2a9e1222649aaf3a",
        "type": "split",
        "z": "2b0ccb33173561a2",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 940,
        "y": 240,
        "wires": [
            [
                "780719aec30f4c05"
            ]
        ]
    },
    {
        "id": "780719aec30f4c05",
        "type": "delay",
        "z": "2b0ccb33173561a2",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 240,
        "wires": [
            [
                "707f5bcb90838fe3"
            ]
        ]
    },
    {
        "id": "a57d311e2c1a1a52",
        "type": "json",
        "z": "2b0ccb33173561a2",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 320,
        "wires": [
            [
                "e5b842f130920c3c"
            ]
        ]
    },
    {
        "id": "e5b842f130920c3c",
        "type": "split",
        "z": "2b0ccb33173561a2",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 940,
        "y": 320,
        "wires": [
            [
                "ffe571d4709920ea"
            ]
        ]
    },
    {
        "id": "ffe571d4709920ea",
        "type": "delay",
        "z": "2b0ccb33173561a2",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 320,
        "wires": [
            [
                "707f5bcb90838fe3"
            ]
        ]
    },
    {
        "id": "3af529fb75f424d1",
        "type": "json",
        "z": "2b0ccb33173561a2",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 400,
        "wires": [
            [
                "c21f4e32f44fcbaa"
            ]
        ]
    },
    {
        "id": "c21f4e32f44fcbaa",
        "type": "split",
        "z": "2b0ccb33173561a2",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 940,
        "y": 400,
        "wires": [
            [
                "6dc910379081874f"
            ]
        ]
    },
    {
        "id": "6dc910379081874f",
        "type": "delay",
        "z": "2b0ccb33173561a2",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 400,
        "wires": [
            [
                "707f5bcb90838fe3"
            ]
        ]
    },
    {
        "id": "ec1ca621389a378d",
        "type": "json",
        "z": "2b0ccb33173561a2",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 480,
        "wires": [
            [
                "bd4a7d167517b0eb"
            ]
        ]
    },
    {
        "id": "bd4a7d167517b0eb",
        "type": "split",
        "z": "2b0ccb33173561a2",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 940,
        "y": 480,
        "wires": [
            [
                "2e88d29214b9f60b"
            ]
        ]
    },
    {
        "id": "2e88d29214b9f60b",
        "type": "delay",
        "z": "2b0ccb33173561a2",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 480,
        "wires": [
            [
                "707f5bcb90838fe3"
            ]
        ]
    },
    {
        "id": "2180cd4cf6956ad3",
        "type": "json",
        "z": "2b0ccb33173561a2",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 560,
        "wires": [
            [
                "f38f8dda69e37753"
            ]
        ]
    },
    {
        "id": "f38f8dda69e37753",
        "type": "split",
        "z": "2b0ccb33173561a2",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 560,
        "wires": [
            [
                "8cb9ddc031a35d6d"
            ]
        ]
    },
    {
        "id": "8cb9ddc031a35d6d",
        "type": "delay",
        "z": "2b0ccb33173561a2",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 560,
        "wires": [
            [
                "707f5bcb90838fe3"
            ]
        ]
    },
    {
        "id": "6d6626784a92beae",
        "type": "json",
        "z": "2b0ccb33173561a2",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 640,
        "wires": [
            [
                "9fee6dcae73f589a"
            ]
        ]
    },
    {
        "id": "9fee6dcae73f589a",
        "type": "split",
        "z": "2b0ccb33173561a2",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 640,
        "wires": [
            [
                "e405785dc94b3a9f"
            ]
        ]
    },
    {
        "id": "e405785dc94b3a9f",
        "type": "delay",
        "z": "2b0ccb33173561a2",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 640,
        "wires": [
            [
                "707f5bcb90838fe3"
            ]
        ]
    },
    {
        "id": "f7a75f92da81415c",
        "type": "json",
        "z": "2b0ccb33173561a2",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 720,
        "wires": [
            [
                "33e7ccc5a109c073"
            ]
        ]
    },
    {
        "id": "33e7ccc5a109c073",
        "type": "split",
        "z": "2b0ccb33173561a2",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 720,
        "wires": [
            [
                "0972fef6f50f0313"
            ]
        ]
    },
    {
        "id": "0972fef6f50f0313",
        "type": "delay",
        "z": "2b0ccb33173561a2",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 720,
        "wires": [
            [
                "707f5bcb90838fe3"
            ]
        ]
    },
    {
        "id": "2eaf9f6e245d74b5",
        "type": "debug",
        "z": "2b0ccb33173561a2",
        "d": true,
        "name": "Payload - device 04",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1710,
        "y": 300,
        "wires": []
    },
    {
        "id": "2c405e1cdee23cc1",
        "type": "file in",
        "z": "ca64878d00b0b8d5",
        "name": "MP10",
        "filename": "/var/snap/node-red/common/data/device_05/cetesb_cubatao-parisi_mp10_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 490,
        "y": 80,
        "wires": [
            [
                "595c4704e8c50941"
            ]
        ]
    },
    {
        "id": "2df1b5babbc7a221",
        "type": "file in",
        "z": "ca64878d00b0b8d5",
        "name": "MP2.5",
        "filename": "/var/snap/node-red/common/data/device_05/cetesb_cubatao-centro_mp25_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 490,
        "y": 160,
        "wires": [
            [
                "c70a18300f495911"
            ]
        ]
    },
    {
        "id": "b6a5dd918e45400d",
        "type": "file in",
        "z": "ca64878d00b0b8d5",
        "name": "O3",
        "filename": "/var/snap/node-red/common/data/device_05/cetesb_cubatao-centro_o3_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 490,
        "y": 240,
        "wires": [
            [
                "6145447d91d230f0"
            ]
        ]
    },
    {
        "id": "5ae5ca4474642c14",
        "type": "file in",
        "z": "ca64878d00b0b8d5",
        "name": "NO2",
        "filename": "/var/snap/node-red/common/data/device_05/cetesb_cubatao-parisi_no2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 490,
        "y": 320,
        "wires": [
            [
                "a04943e43c10c563"
            ]
        ]
    },
    {
        "id": "740f3c210eed631e",
        "type": "file in",
        "z": "ca64878d00b0b8d5",
        "name": "SO2",
        "filename": "/var/snap/node-red/common/data/device_05/cetesb_cubatao-parisi_so2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 490,
        "y": 400,
        "wires": [
            [
                "2b6348f49bbd85f5"
            ]
        ]
    },
    {
        "id": "54e6d8fe072e2c80",
        "type": "file in",
        "z": "ca64878d00b0b8d5",
        "name": "CO",
        "filename": "/var/snap/node-red/common/data/device_05/cetesb_sao-bernado_co_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 490,
        "y": 480,
        "wires": [
            [
                "849db56fdfa712b9"
            ]
        ]
    },
    {
        "id": "2f9d74e8cdc99625",
        "type": "file in",
        "z": "ca64878d00b0b8d5",
        "name": "Temperatura",
        "filename": "/var/snap/node-red/common/data/device_05/cetesb_cubatao-vale-mogi_temperature_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 510,
        "y": 560,
        "wires": [
            [
                "e9494e6e16777eec"
            ]
        ]
    },
    {
        "id": "856f9afc1229159c",
        "type": "file in",
        "z": "ca64878d00b0b8d5",
        "name": "Umidade do Ar",
        "filename": "/var/snap/node-red/common/data/device_05/cetesb_santos_humidity_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 520,
        "y": 640,
        "wires": [
            [
                "8092014edee7e0b1"
            ]
        ]
    },
    {
        "id": "338a6e630931eaf3",
        "type": "file in",
        "z": "ca64878d00b0b8d5",
        "name": "Pressão",
        "filename": "/var/snap/node-red/common/data/device_05/cetesb_santos_pressure_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 500,
        "y": 720,
        "wires": [
            [
                "45b8b25b3ae6f9ed"
            ]
        ]
    },
    {
        "id": "54ad8a363bc03be9",
        "type": "function",
        "z": "ca64878d00b0b8d5",
        "name": "Device05",
        "func": "// ===== Metadados estáticos do dispositivo =====\nconst DEVICE_META = {\n    deviceId: \"Device05\", // ID único do dispositivo\n    station: \"Hospital Giselda Trigueiro\", // Nome da estação\n    lat: -5.797181720435641, // Latitude e Longitude do dispositivo\n    lon: -35.226140634915325,   // cuidado com espaços antes do número!\n    model: \"Node-RED\", // Modelo do dispositivo\n    fw_version: \"v3.1.0\" // Versão do firmware\n};\n\n// ===== Mapeamento nomes reais -> padronizados =====\nconst mapSensor = {\n    \"mp10\": \"pm10\",\n    \"mp2\": \"pm25\",\n    \"o3\": \"o3\",\n    \"no2\": \"no2\",\n    \"so2\": \"so2\",\n    \"co\": \"co\",\n    \"temp\": \"temperatura\",\n    \"ur\": \"umidade\",\n    \"press\": \"pressao\"\n};\n\nconst sensoresEsperados = Object.values(mapSensor);\n\n// Buffer por timestamp no flow context\nlet buffer = flow.get(\"sensorBuffer\") || {};\n\nconst dado = msg.payload;\nconst ts = dado.timestamp;                // ISO8601/epoch conforme sua entrada\nconst nomeSensor = mapSensor[dado.sensor];\n\nif (!nomeSensor) return null; // ignora sensores desconhecidos\n\n// Cria bucket do timestamp se necessário\nif (!buffer[ts]) buffer[ts] = {};\n\n// Armazena valor padronizado\nbuffer[ts][nomeSensor] = dado.valor;\nflow.set(\"sensorBuffer\", buffer);\n\n// Verifica se todos os sensores chegaram\nconst sensoresPresentes = Object.keys(buffer[ts]);\nconst todosPresentes = sensoresEsperados.every(s => sensoresPresentes.includes(s));\n\nif (todosPresentes) {\n    // Payload final: metadados + geolocalização + timestamp + leituras\n    const payloadFinal = {\n        // --- metadados (topo) ---\n        deviceId: DEVICE_META.deviceId,\n        station: DEVICE_META.station,\n        lat: Number(DEVICE_META.lat),\n        lon: Number(DEVICE_META.lon),\n        model: DEVICE_META.model,\n        fw_version: DEVICE_META.fw_version,\n        // --- tempo ---\n        timestamp: ts\n    };\n\n    // Leituras (flatten para facilitar consumo / Grafana)\n    sensoresEsperados.forEach(s => {\n        payloadFinal[s] = buffer[ts][s] ?? null;\n    });\n\n    // Limpa o bucket do timestamp\n    delete buffer[ts];\n    flow.set(\"sensorBuffer\", buffer);\n\n    // Playload pronto para envio\n    msg.payload = payloadFinal;\n    msg.qos = 1;        // opcional\n    msg.retain = false;    // telemetria normalmente não é retida\n    return msg;\n}\n\n// Ainda aguardando outros sensores desse timestamp\nreturn null;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "// Code added here will be run once\n// whenever the node is started.\nflow.set(\"index\", 0);\nflow.set(\"buffers\", {});\n\n",
        "finalize": "",
        "libs": [],
        "x": 1500,
        "y": 400,
        "wires": [
            [
                "6e29819a72ad9e34",
                "2a11ed7bb655324c"
            ]
        ]
    },
    {
        "id": "6e29819a72ad9e34",
        "type": "mqtt out",
        "z": "ca64878d00b0b8d5",
        "name": "MQTT Client - Publish Telemetria",
        "topic": "airq/devices/device05/telemetria",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "f0c9616a1a5e025a",
        "x": 1780,
        "y": 400,
        "wires": []
    },
    {
        "id": "595c4704e8c50941",
        "type": "json",
        "z": "ca64878d00b0b8d5",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 80,
        "wires": [
            [
                "1fb92eb743c55d05"
            ]
        ]
    },
    {
        "id": "1fb92eb743c55d05",
        "type": "split",
        "z": "ca64878d00b0b8d5",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 970,
        "y": 80,
        "wires": [
            [
                "28d7b893fb36455b"
            ]
        ]
    },
    {
        "id": "28d7b893fb36455b",
        "type": "delay",
        "z": "ca64878d00b0b8d5",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 80,
        "wires": [
            [
                "54ad8a363bc03be9"
            ]
        ]
    },
    {
        "id": "c56fcaa0585fdfd9",
        "type": "inject",
        "z": "ca64878d00b0b8d5",
        "name": "Iniciar simulação",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 190,
        "y": 400,
        "wires": [
            [
                "2c405e1cdee23cc1",
                "2df1b5babbc7a221",
                "b6a5dd918e45400d",
                "5ae5ca4474642c14",
                "740f3c210eed631e",
                "54e6d8fe072e2c80",
                "2f9d74e8cdc99625",
                "856f9afc1229159c",
                "338a6e630931eaf3"
            ]
        ]
    },
    {
        "id": "c70a18300f495911",
        "type": "json",
        "z": "ca64878d00b0b8d5",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 160,
        "wires": [
            [
                "e9ecdbaa8f322145"
            ]
        ]
    },
    {
        "id": "e9ecdbaa8f322145",
        "type": "split",
        "z": "ca64878d00b0b8d5",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 160,
        "wires": [
            [
                "48afaf7e07bcf8e1"
            ]
        ]
    },
    {
        "id": "48afaf7e07bcf8e1",
        "type": "delay",
        "z": "ca64878d00b0b8d5",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 160,
        "wires": [
            [
                "54ad8a363bc03be9"
            ]
        ]
    },
    {
        "id": "6145447d91d230f0",
        "type": "json",
        "z": "ca64878d00b0b8d5",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 240,
        "wires": [
            [
                "8c891133f5a199be"
            ]
        ]
    },
    {
        "id": "8c891133f5a199be",
        "type": "split",
        "z": "ca64878d00b0b8d5",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 240,
        "wires": [
            [
                "877c2145a16b91d8"
            ]
        ]
    },
    {
        "id": "877c2145a16b91d8",
        "type": "delay",
        "z": "ca64878d00b0b8d5",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 240,
        "wires": [
            [
                "54ad8a363bc03be9"
            ]
        ]
    },
    {
        "id": "a04943e43c10c563",
        "type": "json",
        "z": "ca64878d00b0b8d5",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 320,
        "wires": [
            [
                "923a2e6197fcdaed"
            ]
        ]
    },
    {
        "id": "923a2e6197fcdaed",
        "type": "split",
        "z": "ca64878d00b0b8d5",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 320,
        "wires": [
            [
                "42d3ee50d91b947b"
            ]
        ]
    },
    {
        "id": "42d3ee50d91b947b",
        "type": "delay",
        "z": "ca64878d00b0b8d5",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 320,
        "wires": [
            [
                "54ad8a363bc03be9"
            ]
        ]
    },
    {
        "id": "2b6348f49bbd85f5",
        "type": "json",
        "z": "ca64878d00b0b8d5",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 400,
        "wires": [
            [
                "566ffc7f6ee9085d"
            ]
        ]
    },
    {
        "id": "566ffc7f6ee9085d",
        "type": "split",
        "z": "ca64878d00b0b8d5",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 400,
        "wires": [
            [
                "f8cbaedd1c401f6f"
            ]
        ]
    },
    {
        "id": "f8cbaedd1c401f6f",
        "type": "delay",
        "z": "ca64878d00b0b8d5",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 400,
        "wires": [
            [
                "54ad8a363bc03be9"
            ]
        ]
    },
    {
        "id": "849db56fdfa712b9",
        "type": "json",
        "z": "ca64878d00b0b8d5",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 480,
        "wires": [
            [
                "03dbf9381a370fae"
            ]
        ]
    },
    {
        "id": "03dbf9381a370fae",
        "type": "split",
        "z": "ca64878d00b0b8d5",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 480,
        "wires": [
            [
                "c34611587cad99c6"
            ]
        ]
    },
    {
        "id": "c34611587cad99c6",
        "type": "delay",
        "z": "ca64878d00b0b8d5",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 480,
        "wires": [
            [
                "54ad8a363bc03be9"
            ]
        ]
    },
    {
        "id": "e9494e6e16777eec",
        "type": "json",
        "z": "ca64878d00b0b8d5",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 560,
        "wires": [
            [
                "ea14ea71935168e0"
            ]
        ]
    },
    {
        "id": "ea14ea71935168e0",
        "type": "split",
        "z": "ca64878d00b0b8d5",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 980,
        "y": 560,
        "wires": [
            [
                "50d8ec3163f42ed9"
            ]
        ]
    },
    {
        "id": "50d8ec3163f42ed9",
        "type": "delay",
        "z": "ca64878d00b0b8d5",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 560,
        "wires": [
            [
                "54ad8a363bc03be9"
            ]
        ]
    },
    {
        "id": "8092014edee7e0b1",
        "type": "json",
        "z": "ca64878d00b0b8d5",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 640,
        "wires": [
            [
                "f91bed6580627b1e"
            ]
        ]
    },
    {
        "id": "f91bed6580627b1e",
        "type": "split",
        "z": "ca64878d00b0b8d5",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 980,
        "y": 640,
        "wires": [
            [
                "661d96cefbcacf3e"
            ]
        ]
    },
    {
        "id": "661d96cefbcacf3e",
        "type": "delay",
        "z": "ca64878d00b0b8d5",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 640,
        "wires": [
            [
                "54ad8a363bc03be9"
            ]
        ]
    },
    {
        "id": "45b8b25b3ae6f9ed",
        "type": "json",
        "z": "ca64878d00b0b8d5",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 720,
        "wires": [
            [
                "d5bb1863a4036a2f"
            ]
        ]
    },
    {
        "id": "d5bb1863a4036a2f",
        "type": "split",
        "z": "ca64878d00b0b8d5",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 980,
        "y": 720,
        "wires": [
            [
                "8d0da730024fc561"
            ]
        ]
    },
    {
        "id": "8d0da730024fc561",
        "type": "delay",
        "z": "ca64878d00b0b8d5",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 720,
        "wires": [
            [
                "54ad8a363bc03be9"
            ]
        ]
    },
    {
        "id": "2a11ed7bb655324c",
        "type": "debug",
        "z": "ca64878d00b0b8d5",
        "d": true,
        "name": "Payload - device 05",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1730,
        "y": 300,
        "wires": []
    },
    {
        "id": "0b6b7c5955bcf0e6",
        "type": "file in",
        "z": "ce876ccd83b6b630",
        "name": "MP10",
        "filename": "/var/snap/node-red/common/data/device_06/cetesb_santa-gertrudes_mp10_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 490,
        "y": 80,
        "wires": [
            [
                "6494e399e80231d7"
            ]
        ]
    },
    {
        "id": "39311b2b2b333ed6",
        "type": "file in",
        "z": "ce876ccd83b6b630",
        "name": "MP2.5",
        "filename": "/var/snap/node-red/common/data/device_06/cetesb_rio-claro_mp25_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 490,
        "y": 160,
        "wires": [
            [
                "9995c2e526e60e89"
            ]
        ]
    },
    {
        "id": "450ae0b43951c519",
        "type": "file in",
        "z": "ce876ccd83b6b630",
        "name": "O3",
        "filename": "/var/snap/node-red/common/data/device_06/cetesb_rio-claro_o3_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 490,
        "y": 240,
        "wires": [
            [
                "4e4d2859cec3f012"
            ]
        ]
    },
    {
        "id": "16d793a33dd91fcf",
        "type": "file in",
        "z": "ce876ccd83b6b630",
        "name": "NO2",
        "filename": "/var/snap/node-red/common/data/device_06/cetesb_santa-gertrudes_no2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 490,
        "y": 320,
        "wires": [
            [
                "2145414afaa7b1c4"
            ]
        ]
    },
    {
        "id": "065632f25ed748a2",
        "type": "file in",
        "z": "ce876ccd83b6b630",
        "name": "SO2",
        "filename": "/var/snap/node-red/common/data/device_06/cetesb_guarulhos_so2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 490,
        "y": 400,
        "wires": [
            [
                "6d26f4d0d2b44992"
            ]
        ]
    },
    {
        "id": "2439753ea565f8b2",
        "type": "file in",
        "z": "ce876ccd83b6b630",
        "name": "CO",
        "filename": "/var/snap/node-red/common/data/device_06/cetesb_guarulhos_co_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 490,
        "y": 480,
        "wires": [
            [
                "1b790820dfc570c8"
            ]
        ]
    },
    {
        "id": "4b73bc30328f2ad1",
        "type": "file in",
        "z": "ce876ccd83b6b630",
        "name": "Temperatura",
        "filename": "/var/snap/node-red/common/data/device_06/cetesb_santa-gertrudes_temperature_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 510,
        "y": 560,
        "wires": [
            [
                "6b70847c7dd9f268"
            ]
        ]
    },
    {
        "id": "f40680efd7a78977",
        "type": "file in",
        "z": "ce876ccd83b6b630",
        "name": "Umidade do Ar",
        "filename": "/var/snap/node-red/common/data/device_06/cetesb_santa-gertrudes_humidity_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 520,
        "y": 640,
        "wires": [
            [
                "350deedf4307eafd"
            ]
        ]
    },
    {
        "id": "2eeba2345b3ddcbe",
        "type": "file in",
        "z": "ce876ccd83b6b630",
        "name": "Pressão",
        "filename": "/var/snap/node-red/common/data/device_06/cetesb_rio-claro_pressure_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 500,
        "y": 720,
        "wires": [
            [
                "73151965aab1a2e5"
            ]
        ]
    },
    {
        "id": "f5073544a14f6764",
        "type": "function",
        "z": "ce876ccd83b6b630",
        "name": "Device06",
        "func": "// ===== Metadados estáticos do dispositivo =====\nconst DEVICE_META = {\n    deviceId: \"Device06\", // ID único do dispositivo\n    station: \"Parque da Cidade\", // Nome da estação\n    lat: -5.8502776666693554, // Latitude e Longitude do dispositivo\n    lon: -35.22641684099438,  // cuidado com espaços antes do número!\n    model: \"Node-RED\", // Modelo do dispositivo\n    fw_version: \"v3.1.0\" // Versão do firmware\n};\n\n// ===== Mapeamento nomes reais -> padronizados =====\nconst mapSensor = {\n    \"mp10\": \"pm10\",\n    \"mp2\": \"pm25\",\n    \"o3\": \"o3\",\n    \"no2\": \"no2\",\n    \"so2\": \"so2\",\n    \"co\": \"co\",\n    \"temp\": \"temperatura\",\n    \"ur\": \"umidade\",\n    \"press\": \"pressao\"\n};\n\nconst sensoresEsperados = Object.values(mapSensor);\n\n// Buffer por timestamp no flow context\nlet buffer = flow.get(\"sensorBuffer\") || {};\n\nconst dado = msg.payload;\nconst ts = dado.timestamp;                // ISO8601/epoch conforme sua entrada\nconst nomeSensor = mapSensor[dado.sensor];\n\nif (!nomeSensor) return null; // ignora sensores desconhecidos\n\n// Cria bucket do timestamp se necessário\nif (!buffer[ts]) buffer[ts] = {};\n\n// Armazena valor padronizado\nbuffer[ts][nomeSensor] = dado.valor;\nflow.set(\"sensorBuffer\", buffer);\n\n// Verifica se todos os sensores chegaram\nconst sensoresPresentes = Object.keys(buffer[ts]);\nconst todosPresentes = sensoresEsperados.every(s => sensoresPresentes.includes(s));\n\nif (todosPresentes) {\n    // Payload final: metadados + geolocalização + timestamp + leituras\n    const payloadFinal = {\n        // --- metadados (topo) ---\n        deviceId: DEVICE_META.deviceId,\n        station: DEVICE_META.station,\n        lat: Number(DEVICE_META.lat),\n        lon: Number(DEVICE_META.lon),\n        model: DEVICE_META.model,\n        fw_version: DEVICE_META.fw_version,\n        // --- tempo ---\n        timestamp: ts\n    };\n\n    // Leituras (flatten para facilitar consumo / Grafana)\n    sensoresEsperados.forEach(s => {\n        payloadFinal[s] = buffer[ts][s] ?? null;\n    });\n\n    // Limpa o bucket do timestamp\n    delete buffer[ts];\n    flow.set(\"sensorBuffer\", buffer);\n\n    // Playload pronto para envio\n    msg.payload = payloadFinal;\n    msg.qos = 1;        // opcional\n    msg.retain = false;    // telemetria normalmente não é retida\n    return msg;\n}\n\n// Ainda aguardando outros sensores desse timestamp\nreturn null;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "// Code added here will be run once\n// whenever the node is started.\nflow.set(\"index\", 0);\nflow.set(\"buffers\", {});\n\n",
        "finalize": "",
        "libs": [],
        "x": 1500,
        "y": 400,
        "wires": [
            [
                "8cd80515493fb9d0",
                "e9ce2794af472ba0"
            ]
        ]
    },
    {
        "id": "8cd80515493fb9d0",
        "type": "mqtt out",
        "z": "ce876ccd83b6b630",
        "name": "MQTT Client - Publish Telemetria",
        "topic": "airq/devices/device06/telemetria",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "441c3139bc58fc6a",
        "x": 1780,
        "y": 400,
        "wires": []
    },
    {
        "id": "6494e399e80231d7",
        "type": "json",
        "z": "ce876ccd83b6b630",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 80,
        "wires": [
            [
                "ef5dd44d18e50234"
            ]
        ]
    },
    {
        "id": "ef5dd44d18e50234",
        "type": "split",
        "z": "ce876ccd83b6b630",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 970,
        "y": 80,
        "wires": [
            [
                "4133140952f2be25"
            ]
        ]
    },
    {
        "id": "4133140952f2be25",
        "type": "delay",
        "z": "ce876ccd83b6b630",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 80,
        "wires": [
            [
                "f5073544a14f6764"
            ]
        ]
    },
    {
        "id": "94d78a9ccecb6d6b",
        "type": "inject",
        "z": "ce876ccd83b6b630",
        "name": "Iniciar simulação",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 190,
        "y": 400,
        "wires": [
            [
                "0b6b7c5955bcf0e6",
                "39311b2b2b333ed6",
                "450ae0b43951c519",
                "16d793a33dd91fcf",
                "065632f25ed748a2",
                "2439753ea565f8b2",
                "4b73bc30328f2ad1",
                "f40680efd7a78977",
                "2eeba2345b3ddcbe"
            ]
        ]
    },
    {
        "id": "9995c2e526e60e89",
        "type": "json",
        "z": "ce876ccd83b6b630",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 160,
        "wires": [
            [
                "a5df8d1e56c443e0"
            ]
        ]
    },
    {
        "id": "a5df8d1e56c443e0",
        "type": "split",
        "z": "ce876ccd83b6b630",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 160,
        "wires": [
            [
                "64aa5364b5c0a675"
            ]
        ]
    },
    {
        "id": "64aa5364b5c0a675",
        "type": "delay",
        "z": "ce876ccd83b6b630",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 160,
        "wires": [
            [
                "f5073544a14f6764"
            ]
        ]
    },
    {
        "id": "4e4d2859cec3f012",
        "type": "json",
        "z": "ce876ccd83b6b630",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 240,
        "wires": [
            [
                "8e90b777aa137ed4"
            ]
        ]
    },
    {
        "id": "8e90b777aa137ed4",
        "type": "split",
        "z": "ce876ccd83b6b630",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 240,
        "wires": [
            [
                "9e1de4ef7efae3fc"
            ]
        ]
    },
    {
        "id": "9e1de4ef7efae3fc",
        "type": "delay",
        "z": "ce876ccd83b6b630",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 240,
        "wires": [
            [
                "f5073544a14f6764"
            ]
        ]
    },
    {
        "id": "2145414afaa7b1c4",
        "type": "json",
        "z": "ce876ccd83b6b630",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 320,
        "wires": [
            [
                "ceb683937c591ea7"
            ]
        ]
    },
    {
        "id": "ceb683937c591ea7",
        "type": "split",
        "z": "ce876ccd83b6b630",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 320,
        "wires": [
            [
                "fcc2e490e6af14ef"
            ]
        ]
    },
    {
        "id": "fcc2e490e6af14ef",
        "type": "delay",
        "z": "ce876ccd83b6b630",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 320,
        "wires": [
            [
                "f5073544a14f6764"
            ]
        ]
    },
    {
        "id": "6d26f4d0d2b44992",
        "type": "json",
        "z": "ce876ccd83b6b630",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 400,
        "wires": [
            [
                "60abbb3931c0c514"
            ]
        ]
    },
    {
        "id": "60abbb3931c0c514",
        "type": "split",
        "z": "ce876ccd83b6b630",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 400,
        "wires": [
            [
                "e62e6ac17c440d28"
            ]
        ]
    },
    {
        "id": "e62e6ac17c440d28",
        "type": "delay",
        "z": "ce876ccd83b6b630",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 400,
        "wires": [
            [
                "f5073544a14f6764"
            ]
        ]
    },
    {
        "id": "1b790820dfc570c8",
        "type": "json",
        "z": "ce876ccd83b6b630",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 480,
        "wires": [
            [
                "e504c81c59cc29e5"
            ]
        ]
    },
    {
        "id": "e504c81c59cc29e5",
        "type": "split",
        "z": "ce876ccd83b6b630",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 480,
        "wires": [
            [
                "506ff33682ee6c82"
            ]
        ]
    },
    {
        "id": "506ff33682ee6c82",
        "type": "delay",
        "z": "ce876ccd83b6b630",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 480,
        "wires": [
            [
                "f5073544a14f6764"
            ]
        ]
    },
    {
        "id": "6b70847c7dd9f268",
        "type": "json",
        "z": "ce876ccd83b6b630",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 560,
        "wires": [
            [
                "728bd1732163493b"
            ]
        ]
    },
    {
        "id": "728bd1732163493b",
        "type": "split",
        "z": "ce876ccd83b6b630",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 980,
        "y": 560,
        "wires": [
            [
                "3feef24c852524b0"
            ]
        ]
    },
    {
        "id": "3feef24c852524b0",
        "type": "delay",
        "z": "ce876ccd83b6b630",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 560,
        "wires": [
            [
                "f5073544a14f6764"
            ]
        ]
    },
    {
        "id": "350deedf4307eafd",
        "type": "json",
        "z": "ce876ccd83b6b630",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 640,
        "wires": [
            [
                "235bbf3c4546e396"
            ]
        ]
    },
    {
        "id": "235bbf3c4546e396",
        "type": "split",
        "z": "ce876ccd83b6b630",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 980,
        "y": 640,
        "wires": [
            [
                "ec9cc53799c21e1f"
            ]
        ]
    },
    {
        "id": "ec9cc53799c21e1f",
        "type": "delay",
        "z": "ce876ccd83b6b630",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 640,
        "wires": [
            [
                "f5073544a14f6764"
            ]
        ]
    },
    {
        "id": "73151965aab1a2e5",
        "type": "json",
        "z": "ce876ccd83b6b630",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 720,
        "wires": [
            [
                "f5235cdabbde4794"
            ]
        ]
    },
    {
        "id": "f5235cdabbde4794",
        "type": "split",
        "z": "ce876ccd83b6b630",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 980,
        "y": 720,
        "wires": [
            [
                "3ec60d131b526d25"
            ]
        ]
    },
    {
        "id": "3ec60d131b526d25",
        "type": "delay",
        "z": "ce876ccd83b6b630",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 720,
        "wires": [
            [
                "f5073544a14f6764"
            ]
        ]
    },
    {
        "id": "e9ce2794af472ba0",
        "type": "debug",
        "z": "ce876ccd83b6b630",
        "d": true,
        "name": "Payload - device 06",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1730,
        "y": 300,
        "wires": []
    },
    {
        "id": "548a3089f6a77eef",
        "type": "debug",
        "z": "e3034ee0d241dc1b",
        "d": true,
        "name": "Payload - device 07",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1730,
        "y": 320,
        "wires": []
    },
    {
        "id": "6ff7891270a03531",
        "type": "file in",
        "z": "e3034ee0d241dc1b",
        "name": "MP10",
        "filename": "/var/snap/node-red/common/data/device_01/cetesb_osasco_mp10_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 490,
        "y": 100,
        "wires": [
            [
                "19d9ecbd1040525a"
            ]
        ]
    },
    {
        "id": "fa9e504e6ec885f5",
        "type": "file in",
        "z": "e3034ee0d241dc1b",
        "name": "MP2.5",
        "filename": "/var/snap/node-red/common/data/device_01/cetesb_osasco_mp25_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 490,
        "y": 180,
        "wires": [
            [
                "88b0f577ce9778a5"
            ]
        ]
    },
    {
        "id": "a63ba41954d0bbc2",
        "type": "file in",
        "z": "e3034ee0d241dc1b",
        "name": "O3",
        "filename": "/var/snap/node-red/common/data/device_01/cetesb_carapicuiba_o3_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 490,
        "y": 260,
        "wires": [
            [
                "f12742520bcd66e0"
            ]
        ]
    },
    {
        "id": "19d9ecbd1040525a",
        "type": "json",
        "z": "e3034ee0d241dc1b",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 100,
        "wires": [
            [
                "0f5ddf0f8a0ec042"
            ]
        ]
    },
    {
        "id": "0f5ddf0f8a0ec042",
        "type": "split",
        "z": "e3034ee0d241dc1b",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 970,
        "y": 100,
        "wires": [
            [
                "44cb0029ee7eea82"
            ]
        ]
    },
    {
        "id": "44cb0029ee7eea82",
        "type": "delay",
        "z": "e3034ee0d241dc1b",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 100,
        "wires": [
            [
                "62f7f53a7519a004"
            ]
        ]
    },
    {
        "id": "88b0f577ce9778a5",
        "type": "json",
        "z": "e3034ee0d241dc1b",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 180,
        "wires": [
            [
                "85a25b49eeb59f2a"
            ]
        ]
    },
    {
        "id": "85a25b49eeb59f2a",
        "type": "split",
        "z": "e3034ee0d241dc1b",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 180,
        "wires": [
            [
                "dad9669ad602c869"
            ]
        ]
    },
    {
        "id": "dad9669ad602c869",
        "type": "delay",
        "z": "e3034ee0d241dc1b",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 180,
        "wires": [
            [
                "62f7f53a7519a004"
            ]
        ]
    },
    {
        "id": "f12742520bcd66e0",
        "type": "json",
        "z": "e3034ee0d241dc1b",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 260,
        "wires": [
            [
                "7324f85198f164a2"
            ]
        ]
    },
    {
        "id": "7324f85198f164a2",
        "type": "split",
        "z": "e3034ee0d241dc1b",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 260,
        "wires": [
            [
                "453324bda7f9879d"
            ]
        ]
    },
    {
        "id": "453324bda7f9879d",
        "type": "delay",
        "z": "e3034ee0d241dc1b",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 260,
        "wires": [
            [
                "62f7f53a7519a004"
            ]
        ]
    },
    {
        "id": "7aff296e3e319504",
        "type": "file in",
        "z": "e3034ee0d241dc1b",
        "name": "NO2",
        "filename": "/var/snap/node-red/common/data/device_01/cetesb_osasco_no2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 490,
        "y": 340,
        "wires": [
            [
                "16024da2d1cc490f"
            ]
        ]
    },
    {
        "id": "75dc4d42573d6925",
        "type": "file in",
        "z": "e3034ee0d241dc1b",
        "name": "SO2",
        "filename": "/var/snap/node-red/common/data/device_01/cetesb_osasco_so2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 490,
        "y": 420,
        "wires": [
            [
                "98922dbadce820f8"
            ]
        ]
    },
    {
        "id": "efd071d8e54da9cb",
        "type": "file in",
        "z": "e3034ee0d241dc1b",
        "name": "CO",
        "filename": "/var/snap/node-red/common/data/device_01/cetesb_osasco_co_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 490,
        "y": 500,
        "wires": [
            [
                "39167aca49dffbd8"
            ]
        ]
    },
    {
        "id": "0d6704d82ad85a8d",
        "type": "file in",
        "z": "e3034ee0d241dc1b",
        "name": "Temperatura",
        "filename": "/var/snap/node-red/common/data/device_01/cetesb_carapicuiba_temperature_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 510,
        "y": 580,
        "wires": [
            [
                "c5d44d3dcb6e9b90"
            ]
        ]
    },
    {
        "id": "6dc17c7e759f4d54",
        "type": "file in",
        "z": "e3034ee0d241dc1b",
        "name": "Umidade do Ar",
        "filename": "/var/snap/node-red/common/data/device_01/cetesb_carapicuiba_humidity_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 520,
        "y": 660,
        "wires": [
            [
                "e9d25d60880a442b"
            ]
        ]
    },
    {
        "id": "43ab34decac59795",
        "type": "file in",
        "z": "e3034ee0d241dc1b",
        "name": "Pressão",
        "filename": "/var/snap/node-red/common/data/device_01/cetesb_carapicuiba_pressure_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 500,
        "y": 740,
        "wires": [
            [
                "be374b3d1b2f57ab"
            ]
        ]
    },
    {
        "id": "62f7f53a7519a004",
        "type": "function",
        "z": "e3034ee0d241dc1b",
        "name": "Device07",
        "func": "// ===== Metadados estáticos do dispositivo =====\nconst DEVICE_META = {\n    deviceId: \"Device07\", // ID único do dispositivo\n    station: \"Ponte Newton Navarro\", // Nome da estação\n    lat: -5.756245088927569, // Latitude e Longitude do dispositivo\n    lon: -35.2022248957448,  // cuidado com espaços antes do número!\n    model: \"Node-RED\", // Modelo do dispositivo\n    fw_version: \"v3.1.0\" // Versão do firmware\n};\n\n// ===== Mapeamento nomes reais -> padronizados =====\nconst mapSensor = {\n    \"mp10\": \"pm10\",\n    \"mp2\": \"pm25\",\n    \"o3\": \"o3\",\n    \"no2\": \"no2\",\n    \"so2\": \"so2\",\n    \"co\": \"co\",\n    \"temp\": \"temperatura\",\n    \"ur\": \"umidade\",\n    \"press\": \"pressao\"\n};\n\nconst sensoresEsperados = Object.values(mapSensor);\n\n// Buffer por timestamp no flow context\nlet buffer = flow.get(\"sensorBuffer\") || {};\n\nconst dado = msg.payload;\nconst ts = dado.timestamp;                // ISO8601/epoch conforme sua entrada\nconst nomeSensor = mapSensor[dado.sensor];\n\nif (!nomeSensor) return null; // ignora sensores desconhecidos\n\n// Cria bucket do timestamp se necessário\nif (!buffer[ts]) buffer[ts] = {};\n\n// Armazena valor padronizado\nbuffer[ts][nomeSensor] = dado.valor;\nflow.set(\"sensorBuffer\", buffer);\n\n// Verifica se todos os sensores chegaram\nconst sensoresPresentes = Object.keys(buffer[ts]);\nconst todosPresentes = sensoresEsperados.every(s => sensoresPresentes.includes(s));\n\nif (todosPresentes) {\n    // Payload final: metadados + geolocalização + timestamp + leituras\n    const payloadFinal = {\n        // --- metadados (topo) ---\n        deviceId: DEVICE_META.deviceId,\n        station: DEVICE_META.station,\n        lat: Number(DEVICE_META.lat),\n        lon: Number(DEVICE_META.lon),\n        model: DEVICE_META.model,\n        fw_version: DEVICE_META.fw_version,\n        // --- tempo ---\n        timestamp: ts\n    };\n\n    // Leituras (flatten para facilitar consumo / Grafana)\n    sensoresEsperados.forEach(s => {\n        payloadFinal[s] = buffer[ts][s] ?? null;\n    });\n\n    // Limpa o bucket do timestamp\n    delete buffer[ts];\n    flow.set(\"sensorBuffer\", buffer);\n\n    // Playload pronto para envio\n    msg.payload = payloadFinal;\n    msg.qos = 1;        // opcional\n    msg.retain = false;    // telemetria normalmente não é retida\n    return msg;\n}\n\n// Ainda aguardando outros sensores desse timestamp\nreturn null;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "// Code added here will be run once\n// whenever the node is started.\nflow.set(\"index\", 0);\nflow.set(\"buffers\", {});\n\n",
        "finalize": "",
        "libs": [],
        "x": 1500,
        "y": 420,
        "wires": [
            [
                "9ea57326908715fe",
                "548a3089f6a77eef"
            ]
        ]
    },
    {
        "id": "9ea57326908715fe",
        "type": "mqtt out",
        "z": "e3034ee0d241dc1b",
        "name": "MQTT Client - Publish Telemetria",
        "topic": "airq/devices/device07/telemetria",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "77c5c034f7bd679b",
        "x": 1780,
        "y": 420,
        "wires": []
    },
    {
        "id": "83dc152c368b7dab",
        "type": "inject",
        "z": "e3034ee0d241dc1b",
        "name": "Iniciar simulação",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 190,
        "y": 420,
        "wires": [
            [
                "7aff296e3e319504",
                "75dc4d42573d6925",
                "efd071d8e54da9cb",
                "0d6704d82ad85a8d",
                "6dc17c7e759f4d54",
                "43ab34decac59795",
                "6ff7891270a03531",
                "fa9e504e6ec885f5",
                "a63ba41954d0bbc2"
            ]
        ]
    },
    {
        "id": "16024da2d1cc490f",
        "type": "json",
        "z": "e3034ee0d241dc1b",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 340,
        "wires": [
            [
                "be0aaac4966cf34f"
            ]
        ]
    },
    {
        "id": "be0aaac4966cf34f",
        "type": "split",
        "z": "e3034ee0d241dc1b",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 340,
        "wires": [
            [
                "690f17a465d9e791"
            ]
        ]
    },
    {
        "id": "690f17a465d9e791",
        "type": "delay",
        "z": "e3034ee0d241dc1b",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 340,
        "wires": [
            [
                "62f7f53a7519a004"
            ]
        ]
    },
    {
        "id": "98922dbadce820f8",
        "type": "json",
        "z": "e3034ee0d241dc1b",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 420,
        "wires": [
            [
                "d7e9918537acb346"
            ]
        ]
    },
    {
        "id": "d7e9918537acb346",
        "type": "split",
        "z": "e3034ee0d241dc1b",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 420,
        "wires": [
            [
                "4081605ffde7823e"
            ]
        ]
    },
    {
        "id": "4081605ffde7823e",
        "type": "delay",
        "z": "e3034ee0d241dc1b",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 420,
        "wires": [
            [
                "62f7f53a7519a004"
            ]
        ]
    },
    {
        "id": "39167aca49dffbd8",
        "type": "json",
        "z": "e3034ee0d241dc1b",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 500,
        "wires": [
            [
                "02cdd3b7068922fb"
            ]
        ]
    },
    {
        "id": "02cdd3b7068922fb",
        "type": "split",
        "z": "e3034ee0d241dc1b",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 500,
        "wires": [
            [
                "c8a0bb2f9ccef778"
            ]
        ]
    },
    {
        "id": "c8a0bb2f9ccef778",
        "type": "delay",
        "z": "e3034ee0d241dc1b",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 500,
        "wires": [
            [
                "62f7f53a7519a004"
            ]
        ]
    },
    {
        "id": "c5d44d3dcb6e9b90",
        "type": "json",
        "z": "e3034ee0d241dc1b",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 580,
        "wires": [
            [
                "323b27daf62ad19b"
            ]
        ]
    },
    {
        "id": "323b27daf62ad19b",
        "type": "split",
        "z": "e3034ee0d241dc1b",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 980,
        "y": 580,
        "wires": [
            [
                "e66878610062b12e"
            ]
        ]
    },
    {
        "id": "e66878610062b12e",
        "type": "delay",
        "z": "e3034ee0d241dc1b",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 580,
        "wires": [
            [
                "62f7f53a7519a004"
            ]
        ]
    },
    {
        "id": "e9d25d60880a442b",
        "type": "json",
        "z": "e3034ee0d241dc1b",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 660,
        "wires": [
            [
                "16e6c6e16a65b645"
            ]
        ]
    },
    {
        "id": "16e6c6e16a65b645",
        "type": "split",
        "z": "e3034ee0d241dc1b",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 980,
        "y": 660,
        "wires": [
            [
                "f3ac6661822defdb"
            ]
        ]
    },
    {
        "id": "f3ac6661822defdb",
        "type": "delay",
        "z": "e3034ee0d241dc1b",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 660,
        "wires": [
            [
                "62f7f53a7519a004"
            ]
        ]
    },
    {
        "id": "be374b3d1b2f57ab",
        "type": "json",
        "z": "e3034ee0d241dc1b",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 740,
        "wires": [
            [
                "1335545626755ec6"
            ]
        ]
    },
    {
        "id": "1335545626755ec6",
        "type": "split",
        "z": "e3034ee0d241dc1b",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 980,
        "y": 740,
        "wires": [
            [
                "63e56b19d0390af3"
            ]
        ]
    },
    {
        "id": "63e56b19d0390af3",
        "type": "delay",
        "z": "e3034ee0d241dc1b",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1210,
        "y": 740,
        "wires": [
            [
                "62f7f53a7519a004"
            ]
        ]
    },
    {
        "id": "b95e36da5ec618b8",
        "type": "file in",
        "z": "aadb65a7e9f1b8ac",
        "name": "MP10",
        "filename": "/var/snap/node-red/common/data/device_02/cetesb_marg-tiete_mp10_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 510,
        "y": 100,
        "wires": [
            [
                "724b56378bf79d83"
            ]
        ]
    },
    {
        "id": "29101b5f20dc6ea2",
        "type": "file in",
        "z": "aadb65a7e9f1b8ac",
        "name": "MP2.5",
        "filename": "/var/snap/node-red/common/data/device_02/cetesb_marg-tiete_mp25_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 510,
        "y": 180,
        "wires": [
            [
                "181e13905211c997"
            ]
        ]
    },
    {
        "id": "c4b7a8b184e72e88",
        "type": "file in",
        "z": "aadb65a7e9f1b8ac",
        "name": "O3",
        "filename": "/var/snap/node-red/common/data/device_02/cetesb_pinheiros_o3_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 510,
        "y": 260,
        "wires": [
            [
                "d7bc5789ba6a9af2"
            ]
        ]
    },
    {
        "id": "4d8dd5576fc1f37e",
        "type": "file in",
        "z": "aadb65a7e9f1b8ac",
        "name": "NO2",
        "filename": "/var/snap/node-red/common/data/device_02/cetesb_marg-tiete_no2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 510,
        "y": 340,
        "wires": [
            [
                "e9d58148342f2d09"
            ]
        ]
    },
    {
        "id": "383f35cc49a8ab48",
        "type": "file in",
        "z": "aadb65a7e9f1b8ac",
        "name": "SO2",
        "filename": "/var/snap/node-red/common/data/device_02/cetesb_marg-tiete_so2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 510,
        "y": 420,
        "wires": [
            [
                "b327f19171324da5"
            ]
        ]
    },
    {
        "id": "cb85f4ecc938bbc9",
        "type": "file in",
        "z": "aadb65a7e9f1b8ac",
        "name": "CO",
        "filename": "/var/snap/node-red/common/data/device_02/cetesb_marg-tiete_co_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 510,
        "y": 500,
        "wires": [
            [
                "2d3e9db264488a6e"
            ]
        ]
    },
    {
        "id": "5c1ab60847988d68",
        "type": "file in",
        "z": "aadb65a7e9f1b8ac",
        "name": "Temperatura",
        "filename": "/var/snap/node-red/common/data/device_02/cetesb_marg-tiete_temperature_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 530,
        "y": 580,
        "wires": [
            [
                "9da2f4ce966f1c14"
            ]
        ]
    },
    {
        "id": "f37fa911604d2c0c",
        "type": "file in",
        "z": "aadb65a7e9f1b8ac",
        "name": "Umidade do Ar",
        "filename": "/var/snap/node-red/common/data/device_02/cetesb_marg-tiete_humidity_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 540,
        "y": 660,
        "wires": [
            [
                "b7ddf61ba9746574"
            ]
        ]
    },
    {
        "id": "44efc5797101195f",
        "type": "file in",
        "z": "aadb65a7e9f1b8ac",
        "name": "Pressão",
        "filename": "/var/snap/node-red/common/data/device_02/cetesb_marg-tiete_pressure_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 520,
        "y": 740,
        "wires": [
            [
                "8efc11e6d59cf7f8"
            ]
        ]
    },
    {
        "id": "3df844252c18979b",
        "type": "function",
        "z": "aadb65a7e9f1b8ac",
        "name": "Device08",
        "func": "// ===== Metadados estáticos do dispositivo =====\nconst DEVICE_META = {\n    deviceId: \"Device08\", // ID único do dispositivo\n    station: \"IFRN - Zona Norte\", // Nome da estação\n    lat: -5.749109999475569, // Latitude e Longitude do dispositivo\n    lon: -35.26047867275991,  // cuidado com espaços antes do número!\n    model: \"Node-RED\", // Modelo do dispositivo\n    fw_version: \"v3.1.0\" // Versão do firmware\n};\n\n// ===== Mapeamento nomes reais -> padronizados =====\nconst mapSensor = {\n    \"mp10\": \"pm10\",\n    \"mp2\": \"pm25\",\n    \"o3\": \"o3\",\n    \"no2\": \"no2\",\n    \"so2\": \"so2\",\n    \"co\": \"co\",\n    \"temp\": \"temperatura\",\n    \"ur\": \"umidade\",\n    \"press\": \"pressao\"\n};\n\nconst sensoresEsperados = Object.values(mapSensor);\n\n// Buffer por timestamp no flow context\nlet buffer = flow.get(\"sensorBuffer\") || {};\n\nconst dado = msg.payload;\nconst ts = dado.timestamp;                // ISO8601/epoch conforme sua entrada\nconst nomeSensor = mapSensor[dado.sensor];\n\nif (!nomeSensor) return null; // ignora sensores desconhecidos\n\n// Cria bucket do timestamp se necessário\nif (!buffer[ts]) buffer[ts] = {};\n\n// Armazena valor padronizado\nbuffer[ts][nomeSensor] = dado.valor;\nflow.set(\"sensorBuffer\", buffer);\n\n// Verifica se todos os sensores chegaram\nconst sensoresPresentes = Object.keys(buffer[ts]);\nconst todosPresentes = sensoresEsperados.every(s => sensoresPresentes.includes(s));\n\nif (todosPresentes) {\n    // Payload final: metadados + geolocalização + timestamp + leituras\n    const payloadFinal = {\n        // --- metadados (topo) ---\n        deviceId: DEVICE_META.deviceId,\n        station: DEVICE_META.station,\n        lat: Number(DEVICE_META.lat),\n        lon: Number(DEVICE_META.lon),\n        model: DEVICE_META.model,\n        fw_version: DEVICE_META.fw_version,\n        // --- tempo ---\n        timestamp: ts\n    };\n\n    // Leituras (flatten para facilitar consumo / Grafana)\n    sensoresEsperados.forEach(s => {\n        payloadFinal[s] = buffer[ts][s] ?? null;\n    });\n\n    // Limpa o bucket do timestamp\n    delete buffer[ts];\n    flow.set(\"sensorBuffer\", buffer);\n\n    // Playload pronto para envio\n    msg.payload = payloadFinal;\n    msg.qos = 1;        // opcional\n    msg.retain = false;    // telemetria normalmente não é retida\n    return msg;\n}\n\n// Ainda aguardando outros sensores desse timestamp\nreturn null;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "// Code added here will be run once\n// whenever the node is started.\nflow.set(\"index\", 0);\nflow.set(\"buffers\", {});\n\n",
        "finalize": "",
        "libs": [],
        "x": 1520,
        "y": 420,
        "wires": [
            [
                "cbcf0957c2cf5286",
                "817558f5f6968dc1"
            ]
        ]
    },
    {
        "id": "cbcf0957c2cf5286",
        "type": "mqtt out",
        "z": "aadb65a7e9f1b8ac",
        "name": "MQTT Client - Publish Telemetria",
        "topic": "airq/devices/device08/telemetria",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "1f978df55ca59983",
        "x": 1800,
        "y": 420,
        "wires": []
    },
    {
        "id": "724b56378bf79d83",
        "type": "json",
        "z": "aadb65a7e9f1b8ac",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 770,
        "y": 100,
        "wires": [
            [
                "4e51973b86b914b3"
            ]
        ]
    },
    {
        "id": "4e51973b86b914b3",
        "type": "split",
        "z": "aadb65a7e9f1b8ac",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 990,
        "y": 100,
        "wires": [
            [
                "d8785789a3aa430e"
            ]
        ]
    },
    {
        "id": "d8785789a3aa430e",
        "type": "delay",
        "z": "aadb65a7e9f1b8ac",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1230,
        "y": 100,
        "wires": [
            [
                "3df844252c18979b"
            ]
        ]
    },
    {
        "id": "60bf02e6d7be3219",
        "type": "inject",
        "z": "aadb65a7e9f1b8ac",
        "name": "Iniciar simulação",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 210,
        "y": 420,
        "wires": [
            [
                "b95e36da5ec618b8",
                "29101b5f20dc6ea2",
                "c4b7a8b184e72e88",
                "4d8dd5576fc1f37e",
                "383f35cc49a8ab48",
                "cb85f4ecc938bbc9",
                "5c1ab60847988d68",
                "f37fa911604d2c0c",
                "44efc5797101195f"
            ]
        ]
    },
    {
        "id": "181e13905211c997",
        "type": "json",
        "z": "aadb65a7e9f1b8ac",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 770,
        "y": 180,
        "wires": [
            [
                "ad8ff1e4bc3af105"
            ]
        ]
    },
    {
        "id": "ad8ff1e4bc3af105",
        "type": "split",
        "z": "aadb65a7e9f1b8ac",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 980,
        "y": 180,
        "wires": [
            [
                "d9d4cbbe135d1ffc"
            ]
        ]
    },
    {
        "id": "d9d4cbbe135d1ffc",
        "type": "delay",
        "z": "aadb65a7e9f1b8ac",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1230,
        "y": 180,
        "wires": [
            [
                "3df844252c18979b"
            ]
        ]
    },
    {
        "id": "d7bc5789ba6a9af2",
        "type": "json",
        "z": "aadb65a7e9f1b8ac",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 770,
        "y": 260,
        "wires": [
            [
                "57cc6d363ed6cbf0"
            ]
        ]
    },
    {
        "id": "57cc6d363ed6cbf0",
        "type": "split",
        "z": "aadb65a7e9f1b8ac",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 980,
        "y": 260,
        "wires": [
            [
                "68416907f083343d"
            ]
        ]
    },
    {
        "id": "68416907f083343d",
        "type": "delay",
        "z": "aadb65a7e9f1b8ac",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1230,
        "y": 260,
        "wires": [
            [
                "3df844252c18979b"
            ]
        ]
    },
    {
        "id": "e9d58148342f2d09",
        "type": "json",
        "z": "aadb65a7e9f1b8ac",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 770,
        "y": 340,
        "wires": [
            [
                "83abf594f937d788"
            ]
        ]
    },
    {
        "id": "83abf594f937d788",
        "type": "split",
        "z": "aadb65a7e9f1b8ac",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 980,
        "y": 340,
        "wires": [
            [
                "c14dde6a9dd8084b"
            ]
        ]
    },
    {
        "id": "c14dde6a9dd8084b",
        "type": "delay",
        "z": "aadb65a7e9f1b8ac",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1230,
        "y": 340,
        "wires": [
            [
                "3df844252c18979b"
            ]
        ]
    },
    {
        "id": "b327f19171324da5",
        "type": "json",
        "z": "aadb65a7e9f1b8ac",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 770,
        "y": 420,
        "wires": [
            [
                "7b8f9c69ce86e785"
            ]
        ]
    },
    {
        "id": "7b8f9c69ce86e785",
        "type": "split",
        "z": "aadb65a7e9f1b8ac",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 980,
        "y": 420,
        "wires": [
            [
                "ccd67ad9326e5da0"
            ]
        ]
    },
    {
        "id": "ccd67ad9326e5da0",
        "type": "delay",
        "z": "aadb65a7e9f1b8ac",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1230,
        "y": 420,
        "wires": [
            [
                "3df844252c18979b"
            ]
        ]
    },
    {
        "id": "2d3e9db264488a6e",
        "type": "json",
        "z": "aadb65a7e9f1b8ac",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 770,
        "y": 500,
        "wires": [
            [
                "abcf428cfb8dddd9"
            ]
        ]
    },
    {
        "id": "abcf428cfb8dddd9",
        "type": "split",
        "z": "aadb65a7e9f1b8ac",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 980,
        "y": 500,
        "wires": [
            [
                "9869091beee09b4b"
            ]
        ]
    },
    {
        "id": "9869091beee09b4b",
        "type": "delay",
        "z": "aadb65a7e9f1b8ac",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1230,
        "y": 500,
        "wires": [
            [
                "3df844252c18979b"
            ]
        ]
    },
    {
        "id": "9da2f4ce966f1c14",
        "type": "json",
        "z": "aadb65a7e9f1b8ac",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 770,
        "y": 580,
        "wires": [
            [
                "5cc4de87ee84f3cf"
            ]
        ]
    },
    {
        "id": "5cc4de87ee84f3cf",
        "type": "split",
        "z": "aadb65a7e9f1b8ac",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1000,
        "y": 580,
        "wires": [
            [
                "c94568ed4900639c"
            ]
        ]
    },
    {
        "id": "c94568ed4900639c",
        "type": "delay",
        "z": "aadb65a7e9f1b8ac",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1230,
        "y": 580,
        "wires": [
            [
                "3df844252c18979b"
            ]
        ]
    },
    {
        "id": "b7ddf61ba9746574",
        "type": "json",
        "z": "aadb65a7e9f1b8ac",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 770,
        "y": 660,
        "wires": [
            [
                "4edf31f5a989bc06"
            ]
        ]
    },
    {
        "id": "4edf31f5a989bc06",
        "type": "split",
        "z": "aadb65a7e9f1b8ac",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1000,
        "y": 660,
        "wires": [
            [
                "c1b6a2a165e1fbda"
            ]
        ]
    },
    {
        "id": "c1b6a2a165e1fbda",
        "type": "delay",
        "z": "aadb65a7e9f1b8ac",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1230,
        "y": 660,
        "wires": [
            [
                "3df844252c18979b"
            ]
        ]
    },
    {
        "id": "8efc11e6d59cf7f8",
        "type": "json",
        "z": "aadb65a7e9f1b8ac",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 770,
        "y": 740,
        "wires": [
            [
                "f3576473ea3f33aa"
            ]
        ]
    },
    {
        "id": "f3576473ea3f33aa",
        "type": "split",
        "z": "aadb65a7e9f1b8ac",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1000,
        "y": 740,
        "wires": [
            [
                "acd8d5cfa97d074f"
            ]
        ]
    },
    {
        "id": "acd8d5cfa97d074f",
        "type": "delay",
        "z": "aadb65a7e9f1b8ac",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1230,
        "y": 740,
        "wires": [
            [
                "3df844252c18979b"
            ]
        ]
    },
    {
        "id": "817558f5f6968dc1",
        "type": "debug",
        "z": "aadb65a7e9f1b8ac",
        "d": true,
        "name": "Payload - device 08",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1750,
        "y": 320,
        "wires": []
    },
    {
        "id": "ca453b98f682f525",
        "type": "file in",
        "z": "c061406022c51c80",
        "name": "MP10",
        "filename": "/var/snap/node-red/common/data/device_03/cetesb_parque-dom-pedro_mp10_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 470,
        "y": 100,
        "wires": [
            [
                "5b5a8834ddb112d9"
            ]
        ]
    },
    {
        "id": "a7cf846383cc04ed",
        "type": "file in",
        "z": "c061406022c51c80",
        "name": "MP2.5",
        "filename": "/var/snap/node-red/common/data/device_03/cetesb_parque-dom-pedro_mp25_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 470,
        "y": 180,
        "wires": [
            [
                "f33ef9d1e2a495be"
            ]
        ]
    },
    {
        "id": "05b6d77e31606db8",
        "type": "file in",
        "z": "c061406022c51c80",
        "name": "O3",
        "filename": "/var/snap/node-red/common/data/device_03/cetesb_parque-dom-pedro_o3_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 470,
        "y": 260,
        "wires": [
            [
                "36b4fb75860d87ea"
            ]
        ]
    },
    {
        "id": "42d1a5a86828bc61",
        "type": "file in",
        "z": "c061406022c51c80",
        "name": "NO2",
        "filename": "/var/snap/node-red/common/data/device_03/cetesb_parque-dom-pedro_no2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 470,
        "y": 340,
        "wires": [
            [
                "29589e3ef85a2c9e"
            ]
        ]
    },
    {
        "id": "e797beecc241301d",
        "type": "file in",
        "z": "c061406022c51c80",
        "name": "SO2",
        "filename": "/var/snap/node-red/common/data/device_03/cetesb_cerqueira_so2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 470,
        "y": 420,
        "wires": [
            [
                "a8e4b8bc1b6fc967"
            ]
        ]
    },
    {
        "id": "ee3f56ab0d3aaf5a",
        "type": "file in",
        "z": "c061406022c51c80",
        "name": "CO",
        "filename": "/var/snap/node-red/common/data/device_03/cetesb_parque-dom-pedro_co_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 470,
        "y": 500,
        "wires": [
            [
                "5a887fc466c66d95"
            ]
        ]
    },
    {
        "id": "37e7a92cba88ea57",
        "type": "file in",
        "z": "c061406022c51c80",
        "name": "Temperatura",
        "filename": "/var/snap/node-red/common/data/device_03/cetesb_parque-dom-pedro_temperature_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 490,
        "y": 580,
        "wires": [
            [
                "6522d3cc90ac70aa"
            ]
        ]
    },
    {
        "id": "007a2e6a728a5f4e",
        "type": "file in",
        "z": "c061406022c51c80",
        "name": "Umidade do Ar",
        "filename": "/var/snap/node-red/common/data/device_03/cetesb_parque-dom-pedro_humidity_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 500,
        "y": 660,
        "wires": [
            [
                "8f109520c70e9668"
            ]
        ]
    },
    {
        "id": "5373e3fd57bfe30a",
        "type": "file in",
        "z": "c061406022c51c80",
        "name": "Pressão",
        "filename": "/var/snap/node-red/common/data/device_03/cetesb_parque-dom-pedro_pressure_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 480,
        "y": 740,
        "wires": [
            [
                "9c7f72168a45a21e"
            ]
        ]
    },
    {
        "id": "a48b3e06ede93bf0",
        "type": "function",
        "z": "c061406022c51c80",
        "name": "Device09",
        "func": "// ===== Metadados estáticos do dispositivo =====\nconst DEVICE_META = {\n    deviceId: \"Device09\", // ID único do dispositivo\n    station: \"UERN Zona Norte\", // Nome da estação\n    lat: -5.754351426627635, // Latitude e Longitude do dispositivo\n    lon: -35.239832419621955, // cuidado com espaços antes do número!\n    model: \"Node-RED\", // Modelo do dispositivo\n    fw_version: \"v3.1.0\" // Versão do firmware\n};\n\n// ===== Mapeamento nomes reais -> padronizados =====\nconst mapSensor = {\n    \"mp10\": \"pm10\",\n    \"mp2\": \"pm25\",\n    \"o3\": \"o3\",\n    \"no2\": \"no2\",\n    \"so2\": \"so2\",\n    \"co\": \"co\",\n    \"temp\": \"temperatura\",\n    \"ur\": \"umidade\",\n    \"press\": \"pressao\"\n};\n\nconst sensoresEsperados = Object.values(mapSensor);\n\n// Buffer por timestamp no flow context\nlet buffer = flow.get(\"sensorBuffer\") || {};\n\nconst dado = msg.payload;\nconst ts = dado.timestamp;                // ISO8601/epoch conforme sua entrada\nconst nomeSensor = mapSensor[dado.sensor];\n\nif (!nomeSensor) return null; // ignora sensores desconhecidos\n\n// Cria bucket do timestamp se necessário\nif (!buffer[ts]) buffer[ts] = {};\n\n// Armazena valor padronizado\nbuffer[ts][nomeSensor] = dado.valor;\nflow.set(\"sensorBuffer\", buffer);\n\n// Verifica se todos os sensores chegaram\nconst sensoresPresentes = Object.keys(buffer[ts]);\nconst todosPresentes = sensoresEsperados.every(s => sensoresPresentes.includes(s));\n\nif (todosPresentes) {\n    // Payload final: metadados + geolocalização + timestamp + leituras\n    const payloadFinal = {\n        // --- metadados (topo) ---\n        deviceId: DEVICE_META.deviceId,\n        station: DEVICE_META.station,\n        lat: Number(DEVICE_META.lat),\n        lon: Number(DEVICE_META.lon),\n        model: DEVICE_META.model,\n        fw_version: DEVICE_META.fw_version,\n        // --- tempo ---\n        timestamp: ts\n    };\n\n    // Leituras (flatten para facilitar consumo / Grafana)\n    sensoresEsperados.forEach(s => {\n        payloadFinal[s] = buffer[ts][s] ?? null;\n    });\n\n    // Limpa o bucket do timestamp\n    delete buffer[ts];\n    flow.set(\"sensorBuffer\", buffer);\n\n    // Playload pronto para envio\n    msg.payload = payloadFinal;\n    msg.qos = 1;        // opcional\n    msg.retain = false;    // telemetria normalmente não é retida\n    return msg;\n}\n\n// Ainda aguardando outros sensores desse timestamp\nreturn null;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "// Code added here will be run once\n// whenever the node is started.\nflow.set(\"index\", 0);\nflow.set(\"buffers\", {});\n\n",
        "finalize": "",
        "libs": [],
        "x": 1480,
        "y": 420,
        "wires": [
            [
                "54abd1e75ae8ea0a",
                "0ed08e4985b204b2"
            ]
        ]
    },
    {
        "id": "54abd1e75ae8ea0a",
        "type": "mqtt out",
        "z": "c061406022c51c80",
        "name": "MQTT Client - Publish Telemetria",
        "topic": "airq/devices/device09/telemetria",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "d40ff6db4d15f74d",
        "x": 1760,
        "y": 420,
        "wires": []
    },
    {
        "id": "5b5a8834ddb112d9",
        "type": "json",
        "z": "c061406022c51c80",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 100,
        "wires": [
            [
                "f25fa6fe8c8be6a8"
            ]
        ]
    },
    {
        "id": "f25fa6fe8c8be6a8",
        "type": "split",
        "z": "c061406022c51c80",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 950,
        "y": 100,
        "wires": [
            [
                "1dbf91adb91b263a"
            ]
        ]
    },
    {
        "id": "1dbf91adb91b263a",
        "type": "delay",
        "z": "c061406022c51c80",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 100,
        "wires": [
            [
                "a48b3e06ede93bf0"
            ]
        ]
    },
    {
        "id": "bf69bff7d379f09d",
        "type": "inject",
        "z": "c061406022c51c80",
        "name": "Iniciar simulação",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 170,
        "y": 420,
        "wires": [
            [
                "ca453b98f682f525",
                "a7cf846383cc04ed",
                "05b6d77e31606db8",
                "42d1a5a86828bc61",
                "e797beecc241301d",
                "ee3f56ab0d3aaf5a",
                "37e7a92cba88ea57",
                "007a2e6a728a5f4e",
                "5373e3fd57bfe30a"
            ]
        ]
    },
    {
        "id": "f33ef9d1e2a495be",
        "type": "json",
        "z": "c061406022c51c80",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 180,
        "wires": [
            [
                "8c5a9a0bc38f0e75"
            ]
        ]
    },
    {
        "id": "8c5a9a0bc38f0e75",
        "type": "split",
        "z": "c061406022c51c80",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 940,
        "y": 180,
        "wires": [
            [
                "77ee1b342c14df2f"
            ]
        ]
    },
    {
        "id": "77ee1b342c14df2f",
        "type": "delay",
        "z": "c061406022c51c80",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 180,
        "wires": [
            [
                "a48b3e06ede93bf0"
            ]
        ]
    },
    {
        "id": "36b4fb75860d87ea",
        "type": "json",
        "z": "c061406022c51c80",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 260,
        "wires": [
            [
                "66ff053e6d7ec3bb"
            ]
        ]
    },
    {
        "id": "66ff053e6d7ec3bb",
        "type": "split",
        "z": "c061406022c51c80",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 940,
        "y": 260,
        "wires": [
            [
                "4b6d7a83f1c27b55"
            ]
        ]
    },
    {
        "id": "4b6d7a83f1c27b55",
        "type": "delay",
        "z": "c061406022c51c80",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 260,
        "wires": [
            [
                "a48b3e06ede93bf0"
            ]
        ]
    },
    {
        "id": "29589e3ef85a2c9e",
        "type": "json",
        "z": "c061406022c51c80",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 340,
        "wires": [
            [
                "39515130655c4168"
            ]
        ]
    },
    {
        "id": "39515130655c4168",
        "type": "split",
        "z": "c061406022c51c80",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 940,
        "y": 340,
        "wires": [
            [
                "147528a417c64759"
            ]
        ]
    },
    {
        "id": "147528a417c64759",
        "type": "delay",
        "z": "c061406022c51c80",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 340,
        "wires": [
            [
                "a48b3e06ede93bf0"
            ]
        ]
    },
    {
        "id": "a8e4b8bc1b6fc967",
        "type": "json",
        "z": "c061406022c51c80",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 420,
        "wires": [
            [
                "681ed160a2ac563c"
            ]
        ]
    },
    {
        "id": "681ed160a2ac563c",
        "type": "split",
        "z": "c061406022c51c80",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 940,
        "y": 420,
        "wires": [
            [
                "7a3c98c0402abd93"
            ]
        ]
    },
    {
        "id": "7a3c98c0402abd93",
        "type": "delay",
        "z": "c061406022c51c80",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 420,
        "wires": [
            [
                "a48b3e06ede93bf0"
            ]
        ]
    },
    {
        "id": "5a887fc466c66d95",
        "type": "json",
        "z": "c061406022c51c80",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 500,
        "wires": [
            [
                "59ffe5adf835f2f3"
            ]
        ]
    },
    {
        "id": "59ffe5adf835f2f3",
        "type": "split",
        "z": "c061406022c51c80",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 940,
        "y": 500,
        "wires": [
            [
                "d6a7042ad85367f3"
            ]
        ]
    },
    {
        "id": "d6a7042ad85367f3",
        "type": "delay",
        "z": "c061406022c51c80",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 500,
        "wires": [
            [
                "a48b3e06ede93bf0"
            ]
        ]
    },
    {
        "id": "6522d3cc90ac70aa",
        "type": "json",
        "z": "c061406022c51c80",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 580,
        "wires": [
            [
                "2a8008530fd42b40"
            ]
        ]
    },
    {
        "id": "2a8008530fd42b40",
        "type": "split",
        "z": "c061406022c51c80",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 580,
        "wires": [
            [
                "1dcc9ad6cd854af4"
            ]
        ]
    },
    {
        "id": "1dcc9ad6cd854af4",
        "type": "delay",
        "z": "c061406022c51c80",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 580,
        "wires": [
            [
                "a48b3e06ede93bf0"
            ]
        ]
    },
    {
        "id": "8f109520c70e9668",
        "type": "json",
        "z": "c061406022c51c80",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 660,
        "wires": [
            [
                "c3623e6d0dfef6dc"
            ]
        ]
    },
    {
        "id": "c3623e6d0dfef6dc",
        "type": "split",
        "z": "c061406022c51c80",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 660,
        "wires": [
            [
                "a4a74347a36239b9"
            ]
        ]
    },
    {
        "id": "a4a74347a36239b9",
        "type": "delay",
        "z": "c061406022c51c80",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 660,
        "wires": [
            [
                "a48b3e06ede93bf0"
            ]
        ]
    },
    {
        "id": "9c7f72168a45a21e",
        "type": "json",
        "z": "c061406022c51c80",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 740,
        "wires": [
            [
                "32f44da98a6dac3d"
            ]
        ]
    },
    {
        "id": "32f44da98a6dac3d",
        "type": "split",
        "z": "c061406022c51c80",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 740,
        "wires": [
            [
                "9535c26dda24c0b9"
            ]
        ]
    },
    {
        "id": "9535c26dda24c0b9",
        "type": "delay",
        "z": "c061406022c51c80",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 740,
        "wires": [
            [
                "a48b3e06ede93bf0"
            ]
        ]
    },
    {
        "id": "0ed08e4985b204b2",
        "type": "debug",
        "z": "c061406022c51c80",
        "d": true,
        "name": "Payload - device 09",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1710,
        "y": 320,
        "wires": []
    },
    {
        "id": "d51fe0ec54281d0e",
        "type": "file in",
        "z": "7fbf436e8b8bf7c4",
        "name": "MP10",
        "filename": "/var/snap/node-red/common/data/device_04/cetesb_congonhas_mp10_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 530,
        "y": 120,
        "wires": [
            [
                "be623ff18654d462"
            ]
        ]
    },
    {
        "id": "c65ace6c316a9570",
        "type": "file in",
        "z": "7fbf436e8b8bf7c4",
        "name": "MP2.5",
        "filename": "/var/snap/node-red/common/data/device_04/cetesb_interlagos_mp25_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 530,
        "y": 200,
        "wires": [
            [
                "103bf39b161185c8"
            ]
        ]
    },
    {
        "id": "4cab746b8b01661f",
        "type": "file in",
        "z": "7fbf436e8b8bf7c4",
        "name": "O3",
        "filename": "/var/snap/node-red/common/data/device_04/cetesb_santo-amaro_o3_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 530,
        "y": 280,
        "wires": [
            [
                "d5125bf47b6d0e49"
            ]
        ]
    },
    {
        "id": "4030d47a19759fca",
        "type": "file in",
        "z": "7fbf436e8b8bf7c4",
        "name": "NO2",
        "filename": "/var/snap/node-red/common/data/device_04/cetesb_congonhas_no2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 530,
        "y": 360,
        "wires": [
            [
                "0ea0818539d5a05f"
            ]
        ]
    },
    {
        "id": "e8f681a90ec533c9",
        "type": "file in",
        "z": "7fbf436e8b8bf7c4",
        "name": "SO2",
        "filename": "/var/snap/node-red/common/data/device_04/cetesb_interlagos_so2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 530,
        "y": 440,
        "wires": [
            [
                "827d3f55cf7e8133"
            ]
        ]
    },
    {
        "id": "77ca71c8fda47f94",
        "type": "file in",
        "z": "7fbf436e8b8bf7c4",
        "name": "CO",
        "filename": "/var/snap/node-red/common/data/device_04/cetesb_santo-amaro_co_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 530,
        "y": 520,
        "wires": [
            [
                "47eaef2321767f0f"
            ]
        ]
    },
    {
        "id": "bfa043b546ca10e3",
        "type": "file in",
        "z": "7fbf436e8b8bf7c4",
        "name": "Temperatura",
        "filename": "/var/snap/node-red/common/data/device_04/cetesb_interlagos_temperature_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 550,
        "y": 600,
        "wires": [
            [
                "c681a7a6d7fededd"
            ]
        ]
    },
    {
        "id": "fa542cdc3be31e39",
        "type": "file in",
        "z": "7fbf436e8b8bf7c4",
        "name": "Umidade do Ar",
        "filename": "/var/snap/node-red/common/data/device_04/cetesb_sao-bernado_humidity_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 560,
        "y": 680,
        "wires": [
            [
                "15d78e27750c2a97"
            ]
        ]
    },
    {
        "id": "34edffe1f66b5a8f",
        "type": "file in",
        "z": "7fbf436e8b8bf7c4",
        "name": "Pressão",
        "filename": "/var/snap/node-red/common/data/device_04/cetesb_sao-bernado_pressure_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 540,
        "y": 760,
        "wires": [
            [
                "adfca7d191852bfc"
            ]
        ]
    },
    {
        "id": "0e6d85f3051f4627",
        "type": "function",
        "z": "7fbf436e8b8bf7c4",
        "name": "Device10",
        "func": "// ===== Metadados estáticos do dispositivo =====\nconst DEVICE_META = {\n    deviceId: \"Device10\", // ID único do dispositivo\n    station: \"Ginásio Nélio Dias\", // Nome da estação\n    lat: -5.7334706433766005, // Latitude e Longitude do dispositivo\n    lon: -35.2539450178753, // cuidado com espaços antes do número!\n    model: \"Node-RED\", // Modelo do dispositivo\n    fw_version: \"v3.1.0\" // Versão do firmware\n};\n\n// ===== Mapeamento nomes reais -> padronizados =====\nconst mapSensor = {\n    \"mp10\": \"pm10\",\n    \"mp2\": \"pm25\",\n    \"o3\": \"o3\",\n    \"no2\": \"no2\",\n    \"so2\": \"so2\",\n    \"co\": \"co\",\n    \"temp\": \"temperatura\",\n    \"ur\": \"umidade\",\n    \"press\": \"pressao\"\n};\n\nconst sensoresEsperados = Object.values(mapSensor);\n\n// Buffer por timestamp no flow context\nlet buffer = flow.get(\"sensorBuffer\") || {};\n\nconst dado = msg.payload;\nconst ts = dado.timestamp;                // ISO8601/epoch conforme sua entrada\nconst nomeSensor = mapSensor[dado.sensor];\n\nif (!nomeSensor) return null; // ignora sensores desconhecidos\n\n// Cria bucket do timestamp se necessário\nif (!buffer[ts]) buffer[ts] = {};\n\n// Armazena valor padronizado\nbuffer[ts][nomeSensor] = dado.valor;\nflow.set(\"sensorBuffer\", buffer);\n\n// Verifica se todos os sensores chegaram\nconst sensoresPresentes = Object.keys(buffer[ts]);\nconst todosPresentes = sensoresEsperados.every(s => sensoresPresentes.includes(s));\n\nif (todosPresentes) {\n    // Payload final: metadados + geolocalização + timestamp + leituras\n    const payloadFinal = {\n        // --- metadados (topo) ---\n        deviceId: DEVICE_META.deviceId,\n        station: DEVICE_META.station,\n        lat: Number(DEVICE_META.lat),\n        lon: Number(DEVICE_META.lon),\n        model: DEVICE_META.model,\n        fw_version: DEVICE_META.fw_version,\n        // --- tempo ---\n        timestamp: ts\n    };\n\n    // Leituras (flatten para facilitar consumo / Grafana)\n    sensoresEsperados.forEach(s => {\n        payloadFinal[s] = buffer[ts][s] ?? null;\n    });\n\n    // Limpa o bucket do timestamp\n    delete buffer[ts];\n    flow.set(\"sensorBuffer\", buffer);\n\n    // Playload pronto para envio\n    msg.payload = payloadFinal;\n    msg.qos = 1;        // opcional\n    msg.retain = false;    // telemetria normalmente não é retida\n    return msg;\n}\n\n// Ainda aguardando outros sensores desse timestamp\nreturn null;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "// Code added here will be run once\n// whenever the node is started.\nflow.set(\"index\", 0);\nflow.set(\"buffers\", {});\n\n",
        "finalize": "",
        "libs": [],
        "x": 1540,
        "y": 440,
        "wires": [
            [
                "9a7090d6c99075b4",
                "2422d2386b95a995"
            ]
        ]
    },
    {
        "id": "9a7090d6c99075b4",
        "type": "mqtt out",
        "z": "7fbf436e8b8bf7c4",
        "name": "MQTT Client - Publish Telemetria",
        "topic": "airq/devices/device10/telemetria",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "9e32057440292cde",
        "x": 1820,
        "y": 440,
        "wires": []
    },
    {
        "id": "be623ff18654d462",
        "type": "json",
        "z": "7fbf436e8b8bf7c4",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 120,
        "wires": [
            [
                "8966018ab4d156e8"
            ]
        ]
    },
    {
        "id": "8966018ab4d156e8",
        "type": "split",
        "z": "7fbf436e8b8bf7c4",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1010,
        "y": 120,
        "wires": [
            [
                "393d104f2ee1a9c4"
            ]
        ]
    },
    {
        "id": "393d104f2ee1a9c4",
        "type": "delay",
        "z": "7fbf436e8b8bf7c4",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 120,
        "wires": [
            [
                "0e6d85f3051f4627"
            ]
        ]
    },
    {
        "id": "9a5a1ba4710b061c",
        "type": "inject",
        "z": "7fbf436e8b8bf7c4",
        "name": "Iniciar simulação",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 230,
        "y": 440,
        "wires": [
            [
                "d51fe0ec54281d0e",
                "c65ace6c316a9570",
                "4cab746b8b01661f",
                "4030d47a19759fca",
                "e8f681a90ec533c9",
                "77ca71c8fda47f94",
                "bfa043b546ca10e3",
                "fa542cdc3be31e39",
                "34edffe1f66b5a8f"
            ]
        ]
    },
    {
        "id": "103bf39b161185c8",
        "type": "json",
        "z": "7fbf436e8b8bf7c4",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 200,
        "wires": [
            [
                "da58209930fa431c"
            ]
        ]
    },
    {
        "id": "da58209930fa431c",
        "type": "split",
        "z": "7fbf436e8b8bf7c4",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1000,
        "y": 200,
        "wires": [
            [
                "2b3284f75771279d"
            ]
        ]
    },
    {
        "id": "2b3284f75771279d",
        "type": "delay",
        "z": "7fbf436e8b8bf7c4",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 200,
        "wires": [
            [
                "0e6d85f3051f4627"
            ]
        ]
    },
    {
        "id": "d5125bf47b6d0e49",
        "type": "json",
        "z": "7fbf436e8b8bf7c4",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 280,
        "wires": [
            [
                "04bc84a4e8a440c0"
            ]
        ]
    },
    {
        "id": "04bc84a4e8a440c0",
        "type": "split",
        "z": "7fbf436e8b8bf7c4",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1000,
        "y": 280,
        "wires": [
            [
                "036cf3e0366d7d2a"
            ]
        ]
    },
    {
        "id": "036cf3e0366d7d2a",
        "type": "delay",
        "z": "7fbf436e8b8bf7c4",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 280,
        "wires": [
            [
                "0e6d85f3051f4627"
            ]
        ]
    },
    {
        "id": "0ea0818539d5a05f",
        "type": "json",
        "z": "7fbf436e8b8bf7c4",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 360,
        "wires": [
            [
                "6cb51a622542beb6"
            ]
        ]
    },
    {
        "id": "6cb51a622542beb6",
        "type": "split",
        "z": "7fbf436e8b8bf7c4",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1000,
        "y": 360,
        "wires": [
            [
                "0366098e1b7a399b"
            ]
        ]
    },
    {
        "id": "0366098e1b7a399b",
        "type": "delay",
        "z": "7fbf436e8b8bf7c4",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 360,
        "wires": [
            [
                "0e6d85f3051f4627"
            ]
        ]
    },
    {
        "id": "827d3f55cf7e8133",
        "type": "json",
        "z": "7fbf436e8b8bf7c4",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 440,
        "wires": [
            [
                "9e8e8de56e8bcbf4"
            ]
        ]
    },
    {
        "id": "9e8e8de56e8bcbf4",
        "type": "split",
        "z": "7fbf436e8b8bf7c4",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1000,
        "y": 440,
        "wires": [
            [
                "2bb4c834fc8f0946"
            ]
        ]
    },
    {
        "id": "2bb4c834fc8f0946",
        "type": "delay",
        "z": "7fbf436e8b8bf7c4",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 440,
        "wires": [
            [
                "0e6d85f3051f4627"
            ]
        ]
    },
    {
        "id": "47eaef2321767f0f",
        "type": "json",
        "z": "7fbf436e8b8bf7c4",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 520,
        "wires": [
            [
                "525d8459845c5666"
            ]
        ]
    },
    {
        "id": "525d8459845c5666",
        "type": "split",
        "z": "7fbf436e8b8bf7c4",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1000,
        "y": 520,
        "wires": [
            [
                "efb620482d7440c9"
            ]
        ]
    },
    {
        "id": "efb620482d7440c9",
        "type": "delay",
        "z": "7fbf436e8b8bf7c4",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 520,
        "wires": [
            [
                "0e6d85f3051f4627"
            ]
        ]
    },
    {
        "id": "c681a7a6d7fededd",
        "type": "json",
        "z": "7fbf436e8b8bf7c4",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 600,
        "wires": [
            [
                "861c003551952774"
            ]
        ]
    },
    {
        "id": "861c003551952774",
        "type": "split",
        "z": "7fbf436e8b8bf7c4",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1020,
        "y": 600,
        "wires": [
            [
                "fa40671295f2952f"
            ]
        ]
    },
    {
        "id": "fa40671295f2952f",
        "type": "delay",
        "z": "7fbf436e8b8bf7c4",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 600,
        "wires": [
            [
                "0e6d85f3051f4627"
            ]
        ]
    },
    {
        "id": "15d78e27750c2a97",
        "type": "json",
        "z": "7fbf436e8b8bf7c4",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 680,
        "wires": [
            [
                "300b94c9fb53e8c7"
            ]
        ]
    },
    {
        "id": "300b94c9fb53e8c7",
        "type": "split",
        "z": "7fbf436e8b8bf7c4",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1020,
        "y": 680,
        "wires": [
            [
                "8e4c9e619c1183d8"
            ]
        ]
    },
    {
        "id": "8e4c9e619c1183d8",
        "type": "delay",
        "z": "7fbf436e8b8bf7c4",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 680,
        "wires": [
            [
                "0e6d85f3051f4627"
            ]
        ]
    },
    {
        "id": "adfca7d191852bfc",
        "type": "json",
        "z": "7fbf436e8b8bf7c4",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 760,
        "wires": [
            [
                "f98c87a1c32c581d"
            ]
        ]
    },
    {
        "id": "f98c87a1c32c581d",
        "type": "split",
        "z": "7fbf436e8b8bf7c4",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1020,
        "y": 760,
        "wires": [
            [
                "9c4ecb5890394f2c"
            ]
        ]
    },
    {
        "id": "9c4ecb5890394f2c",
        "type": "delay",
        "z": "7fbf436e8b8bf7c4",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1250,
        "y": 760,
        "wires": [
            [
                "0e6d85f3051f4627"
            ]
        ]
    },
    {
        "id": "2422d2386b95a995",
        "type": "debug",
        "z": "7fbf436e8b8bf7c4",
        "d": true,
        "name": "Payload - device 10",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1770,
        "y": 340,
        "wires": []
    },
    {
        "id": "63a9bb139311e19e",
        "type": "file in",
        "z": "bb7bae07f6b14a98",
        "name": "MP10",
        "filename": "/var/snap/node-red/common/data/device_05/cetesb_cubatao-parisi_mp10_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 570,
        "y": 160,
        "wires": [
            [
                "6c423ec067ca22cf"
            ]
        ]
    },
    {
        "id": "a6e35b70db3ef171",
        "type": "file in",
        "z": "bb7bae07f6b14a98",
        "name": "MP2.5",
        "filename": "/var/snap/node-red/common/data/device_05/cetesb_cubatao-centro_mp25_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 570,
        "y": 240,
        "wires": [
            [
                "ecf4b6fef36b5e8e"
            ]
        ]
    },
    {
        "id": "86365b44b36fb718",
        "type": "file in",
        "z": "bb7bae07f6b14a98",
        "name": "O3",
        "filename": "/var/snap/node-red/common/data/device_05/cetesb_cubatao-centro_o3_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 570,
        "y": 320,
        "wires": [
            [
                "3828396412f8685a"
            ]
        ]
    },
    {
        "id": "2f3f8c2aa0ad0727",
        "type": "file in",
        "z": "bb7bae07f6b14a98",
        "name": "NO2",
        "filename": "/var/snap/node-red/common/data/device_05/cetesb_cubatao-parisi_no2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 570,
        "y": 400,
        "wires": [
            [
                "f8f846ededfd7fa5"
            ]
        ]
    },
    {
        "id": "52076b752f26e4ed",
        "type": "file in",
        "z": "bb7bae07f6b14a98",
        "name": "SO2",
        "filename": "/var/snap/node-red/common/data/device_05/cetesb_cubatao-parisi_so2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 570,
        "y": 480,
        "wires": [
            [
                "103db3eb43d13432"
            ]
        ]
    },
    {
        "id": "2e49d2225317d920",
        "type": "file in",
        "z": "bb7bae07f6b14a98",
        "name": "CO",
        "filename": "/var/snap/node-red/common/data/device_05/cetesb_sao-bernado_co_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 570,
        "y": 560,
        "wires": [
            [
                "b454fdd00f0d2633"
            ]
        ]
    },
    {
        "id": "8a0e881a3839500e",
        "type": "file in",
        "z": "bb7bae07f6b14a98",
        "name": "Temperatura",
        "filename": "/var/snap/node-red/common/data/device_05/cetesb_cubatao-vale-mogi_temperature_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 590,
        "y": 640,
        "wires": [
            [
                "720cbe27b6d0e511"
            ]
        ]
    },
    {
        "id": "cf6a0152ec8ddf0d",
        "type": "file in",
        "z": "bb7bae07f6b14a98",
        "name": "Umidade do Ar",
        "filename": "/var/snap/node-red/common/data/device_05/cetesb_santos_humidity_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 600,
        "y": 720,
        "wires": [
            [
                "01a249fe23e0d4dd"
            ]
        ]
    },
    {
        "id": "75cfae1b2700ab02",
        "type": "file in",
        "z": "bb7bae07f6b14a98",
        "name": "Pressão",
        "filename": "/var/snap/node-red/common/data/device_05/cetesb_santos_pressure_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 580,
        "y": 800,
        "wires": [
            [
                "c6248e34bfefa38c"
            ]
        ]
    },
    {
        "id": "d985e637c1ef3177",
        "type": "function",
        "z": "bb7bae07f6b14a98",
        "name": "Device11",
        "func": "// ===== Metadados estáticos do dispositivo =====\nconst DEVICE_META = {\n    deviceId: \"Device11\", // ID único do dispositivo\n    station: \"Aquário Natal\", // Nome da estação\n    lat: -5.731375011927249, // Latitude e Longitude do dispositivo\n    lon: -35.20455897242044, // cuidado com espaços antes do número!\n    model: \"Node-RED\", // Modelo do dispositivo\n    fw_version: \"v3.1.0\" // Versão do firmware\n};\n\n// ===== Mapeamento nomes reais -> padronizados =====\nconst mapSensor = {\n    \"mp10\": \"pm10\",\n    \"mp2\": \"pm25\",\n    \"o3\": \"o3\",\n    \"no2\": \"no2\",\n    \"so2\": \"so2\",\n    \"co\": \"co\",\n    \"temp\": \"temperatura\",\n    \"ur\": \"umidade\",\n    \"press\": \"pressao\"\n};\n\nconst sensoresEsperados = Object.values(mapSensor);\n\n// Buffer por timestamp no flow context\nlet buffer = flow.get(\"sensorBuffer\") || {};\n\nconst dado = msg.payload;\nconst ts = dado.timestamp;                // ISO8601/epoch conforme sua entrada\nconst nomeSensor = mapSensor[dado.sensor];\n\nif (!nomeSensor) return null; // ignora sensores desconhecidos\n\n// Cria bucket do timestamp se necessário\nif (!buffer[ts]) buffer[ts] = {};\n\n// Armazena valor padronizado\nbuffer[ts][nomeSensor] = dado.valor;\nflow.set(\"sensorBuffer\", buffer);\n\n// Verifica se todos os sensores chegaram\nconst sensoresPresentes = Object.keys(buffer[ts]);\nconst todosPresentes = sensoresEsperados.every(s => sensoresPresentes.includes(s));\n\nif (todosPresentes) {\n    // Payload final: metadados + geolocalização + timestamp + leituras\n    const payloadFinal = {\n        // --- metadados (topo) ---\n        deviceId: DEVICE_META.deviceId,\n        station: DEVICE_META.station,\n        lat: Number(DEVICE_META.lat),\n        lon: Number(DEVICE_META.lon),\n        model: DEVICE_META.model,\n        fw_version: DEVICE_META.fw_version,\n        // --- tempo ---\n        timestamp: ts\n    };\n\n    // Leituras (flatten para facilitar consumo / Grafana)\n    sensoresEsperados.forEach(s => {\n        payloadFinal[s] = buffer[ts][s] ?? null;\n    });\n\n    // Limpa o bucket do timestamp\n    delete buffer[ts];\n    flow.set(\"sensorBuffer\", buffer);\n\n    // Playload pronto para envio\n    msg.payload = payloadFinal;\n    msg.qos = 1;        // opcional\n    msg.retain = false;    // telemetria normalmente não é retida\n    return msg;\n}\n\n// Ainda aguardando outros sensores desse timestamp\nreturn null;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "// Code added here will be run once\n// whenever the node is started.\nflow.set(\"index\", 0);\nflow.set(\"buffers\", {});\n\n",
        "finalize": "",
        "libs": [],
        "x": 1580,
        "y": 480,
        "wires": [
            [
                "a8734a93f29966c9",
                "6b289cdc6f20c695"
            ]
        ]
    },
    {
        "id": "a8734a93f29966c9",
        "type": "mqtt out",
        "z": "bb7bae07f6b14a98",
        "name": "MQTT Client - Publish Telemetria",
        "topic": "airq/devices/device11/telemetria",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "279bdbbbd604db3a",
        "x": 1860,
        "y": 480,
        "wires": []
    },
    {
        "id": "6c423ec067ca22cf",
        "type": "json",
        "z": "bb7bae07f6b14a98",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 830,
        "y": 160,
        "wires": [
            [
                "3b9592276fcb7d73"
            ]
        ]
    },
    {
        "id": "3b9592276fcb7d73",
        "type": "split",
        "z": "bb7bae07f6b14a98",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1050,
        "y": 160,
        "wires": [
            [
                "3274249b131be06e"
            ]
        ]
    },
    {
        "id": "3274249b131be06e",
        "type": "delay",
        "z": "bb7bae07f6b14a98",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1290,
        "y": 160,
        "wires": [
            [
                "d985e637c1ef3177"
            ]
        ]
    },
    {
        "id": "fbbd01984c29c287",
        "type": "inject",
        "z": "bb7bae07f6b14a98",
        "name": "Iniciar simulação",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 270,
        "y": 480,
        "wires": [
            [
                "63a9bb139311e19e",
                "a6e35b70db3ef171",
                "86365b44b36fb718",
                "2f3f8c2aa0ad0727",
                "52076b752f26e4ed",
                "2e49d2225317d920",
                "8a0e881a3839500e",
                "cf6a0152ec8ddf0d",
                "75cfae1b2700ab02"
            ]
        ]
    },
    {
        "id": "ecf4b6fef36b5e8e",
        "type": "json",
        "z": "bb7bae07f6b14a98",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 830,
        "y": 240,
        "wires": [
            [
                "c9295a0c396b9c7c"
            ]
        ]
    },
    {
        "id": "c9295a0c396b9c7c",
        "type": "split",
        "z": "bb7bae07f6b14a98",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1040,
        "y": 240,
        "wires": [
            [
                "eb67eba553a2067f"
            ]
        ]
    },
    {
        "id": "eb67eba553a2067f",
        "type": "delay",
        "z": "bb7bae07f6b14a98",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1290,
        "y": 240,
        "wires": [
            [
                "d985e637c1ef3177"
            ]
        ]
    },
    {
        "id": "3828396412f8685a",
        "type": "json",
        "z": "bb7bae07f6b14a98",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 830,
        "y": 320,
        "wires": [
            [
                "41db653bb238d0b9"
            ]
        ]
    },
    {
        "id": "41db653bb238d0b9",
        "type": "split",
        "z": "bb7bae07f6b14a98",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1040,
        "y": 320,
        "wires": [
            [
                "0380f1fd5cd4d706"
            ]
        ]
    },
    {
        "id": "0380f1fd5cd4d706",
        "type": "delay",
        "z": "bb7bae07f6b14a98",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1290,
        "y": 320,
        "wires": [
            [
                "d985e637c1ef3177"
            ]
        ]
    },
    {
        "id": "f8f846ededfd7fa5",
        "type": "json",
        "z": "bb7bae07f6b14a98",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 830,
        "y": 400,
        "wires": [
            [
                "5b004f1b9df8a655"
            ]
        ]
    },
    {
        "id": "5b004f1b9df8a655",
        "type": "split",
        "z": "bb7bae07f6b14a98",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1040,
        "y": 400,
        "wires": [
            [
                "a15b877167908b67"
            ]
        ]
    },
    {
        "id": "a15b877167908b67",
        "type": "delay",
        "z": "bb7bae07f6b14a98",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1290,
        "y": 400,
        "wires": [
            [
                "d985e637c1ef3177"
            ]
        ]
    },
    {
        "id": "103db3eb43d13432",
        "type": "json",
        "z": "bb7bae07f6b14a98",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 830,
        "y": 480,
        "wires": [
            [
                "8cae3f13b81507c0"
            ]
        ]
    },
    {
        "id": "8cae3f13b81507c0",
        "type": "split",
        "z": "bb7bae07f6b14a98",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1040,
        "y": 480,
        "wires": [
            [
                "589afcd83349886e"
            ]
        ]
    },
    {
        "id": "589afcd83349886e",
        "type": "delay",
        "z": "bb7bae07f6b14a98",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1290,
        "y": 480,
        "wires": [
            [
                "d985e637c1ef3177"
            ]
        ]
    },
    {
        "id": "b454fdd00f0d2633",
        "type": "json",
        "z": "bb7bae07f6b14a98",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 830,
        "y": 560,
        "wires": [
            [
                "eea2bd15a01005a5"
            ]
        ]
    },
    {
        "id": "eea2bd15a01005a5",
        "type": "split",
        "z": "bb7bae07f6b14a98",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1040,
        "y": 560,
        "wires": [
            [
                "f8d6f7103fa43d7b"
            ]
        ]
    },
    {
        "id": "f8d6f7103fa43d7b",
        "type": "delay",
        "z": "bb7bae07f6b14a98",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1290,
        "y": 560,
        "wires": [
            [
                "d985e637c1ef3177"
            ]
        ]
    },
    {
        "id": "720cbe27b6d0e511",
        "type": "json",
        "z": "bb7bae07f6b14a98",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 830,
        "y": 640,
        "wires": [
            [
                "5b3950a5f2bd6b13"
            ]
        ]
    },
    {
        "id": "5b3950a5f2bd6b13",
        "type": "split",
        "z": "bb7bae07f6b14a98",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1060,
        "y": 640,
        "wires": [
            [
                "df7279bb09736400"
            ]
        ]
    },
    {
        "id": "df7279bb09736400",
        "type": "delay",
        "z": "bb7bae07f6b14a98",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1290,
        "y": 640,
        "wires": [
            [
                "d985e637c1ef3177"
            ]
        ]
    },
    {
        "id": "01a249fe23e0d4dd",
        "type": "json",
        "z": "bb7bae07f6b14a98",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 830,
        "y": 720,
        "wires": [
            [
                "9bdb09afed180e83"
            ]
        ]
    },
    {
        "id": "9bdb09afed180e83",
        "type": "split",
        "z": "bb7bae07f6b14a98",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1060,
        "y": 720,
        "wires": [
            [
                "909d0b61db0b0c80"
            ]
        ]
    },
    {
        "id": "909d0b61db0b0c80",
        "type": "delay",
        "z": "bb7bae07f6b14a98",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1290,
        "y": 720,
        "wires": [
            [
                "d985e637c1ef3177"
            ]
        ]
    },
    {
        "id": "c6248e34bfefa38c",
        "type": "json",
        "z": "bb7bae07f6b14a98",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 830,
        "y": 800,
        "wires": [
            [
                "a8108ecd03ec31f0"
            ]
        ]
    },
    {
        "id": "a8108ecd03ec31f0",
        "type": "split",
        "z": "bb7bae07f6b14a98",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1060,
        "y": 800,
        "wires": [
            [
                "02a8daa68034b7da"
            ]
        ]
    },
    {
        "id": "02a8daa68034b7da",
        "type": "delay",
        "z": "bb7bae07f6b14a98",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1290,
        "y": 800,
        "wires": [
            [
                "d985e637c1ef3177"
            ]
        ]
    },
    {
        "id": "6b289cdc6f20c695",
        "type": "debug",
        "z": "bb7bae07f6b14a98",
        "d": true,
        "name": "Payload - device 05",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1810,
        "y": 380,
        "wires": []
    },
    {
        "id": "2bc08ec6a2439b07",
        "type": "file in",
        "z": "c1189ac503fd8176",
        "name": "MP10",
        "filename": "/var/snap/node-red/common/data/device_06/cetesb_santa-gertrudes_mp10_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 470,
        "y": 120,
        "wires": [
            [
                "3989765cabe52947"
            ]
        ]
    },
    {
        "id": "5761eab5025fab85",
        "type": "file in",
        "z": "c1189ac503fd8176",
        "name": "MP2.5",
        "filename": "/var/snap/node-red/common/data/device_06/cetesb_rio-claro_mp25_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 470,
        "y": 200,
        "wires": [
            [
                "a0d659cf6afd8368"
            ]
        ]
    },
    {
        "id": "43e574170103c3a0",
        "type": "file in",
        "z": "c1189ac503fd8176",
        "name": "O3",
        "filename": "/var/snap/node-red/common/data/device_06/cetesb_rio-claro_o3_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 470,
        "y": 280,
        "wires": [
            [
                "4c2f55ddac031e0d"
            ]
        ]
    },
    {
        "id": "44ea899e3cfe863a",
        "type": "file in",
        "z": "c1189ac503fd8176",
        "name": "NO2",
        "filename": "/var/snap/node-red/common/data/device_06/cetesb_santa-gertrudes_no2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 470,
        "y": 360,
        "wires": [
            [
                "3c70292a1d9d14c5"
            ]
        ]
    },
    {
        "id": "50d5fe1707452fc0",
        "type": "file in",
        "z": "c1189ac503fd8176",
        "name": "SO2",
        "filename": "/var/snap/node-red/common/data/device_06/cetesb_guarulhos_so2_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 470,
        "y": 440,
        "wires": [
            [
                "0162155e220969cd"
            ]
        ]
    },
    {
        "id": "465dd8a6c142672a",
        "type": "file in",
        "z": "c1189ac503fd8176",
        "name": "CO",
        "filename": "/var/snap/node-red/common/data/device_06/cetesb_guarulhos_co_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 470,
        "y": 520,
        "wires": [
            [
                "0802e33b5df26868"
            ]
        ]
    },
    {
        "id": "80fc73d28cfddb92",
        "type": "file in",
        "z": "c1189ac503fd8176",
        "name": "Temperatura",
        "filename": "/var/snap/node-red/common/data/device_06/cetesb_santa-gertrudes_temperature_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 490,
        "y": 600,
        "wires": [
            [
                "eb7e0ecc71b02285"
            ]
        ]
    },
    {
        "id": "306018183ce983ee",
        "type": "file in",
        "z": "c1189ac503fd8176",
        "name": "Umidade do Ar",
        "filename": "/var/snap/node-red/common/data/device_06/cetesb_santa-gertrudes_humidity_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 500,
        "y": 680,
        "wires": [
            [
                "dbdac21169b2bb82"
            ]
        ]
    },
    {
        "id": "a43546fbbd5df340",
        "type": "file in",
        "z": "c1189ac503fd8176",
        "name": "Pressão",
        "filename": "/var/snap/node-red/common/data/device_06/cetesb_rio-claro_pressure_2024.json",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 480,
        "y": 760,
        "wires": [
            [
                "3bea678979e875aa"
            ]
        ]
    },
    {
        "id": "f1674b24453333e0",
        "type": "function",
        "z": "c1189ac503fd8176",
        "name": "Device12",
        "func": "// ===== Metadados estáticos do dispositivo =====\nconst DEVICE_META = {\n    deviceId: \"Device12\", // ID único do dispositivo\n    station: \"Hospital Infantil Maria Alice\", // Nome da estação\n    lat: -5.763483396042317, // Latitude e Longitude do dispositivo\n    lon: -35.282321778592525, // cuidado com espaços antes do número!\n    model: \"Node-RED\", // Modelo do dispositivo\n    fw_version: \"v3.1.0\" // Versão do firmware\n};\n\n// ===== Mapeamento nomes reais -> padronizados =====\nconst mapSensor = {\n    \"mp10\": \"pm10\",\n    \"mp2\": \"pm25\",\n    \"o3\": \"o3\",\n    \"no2\": \"no2\",\n    \"so2\": \"so2\",\n    \"co\": \"co\",\n    \"temp\": \"temperatura\",\n    \"ur\": \"umidade\",\n    \"press\": \"pressao\"\n};\n\nconst sensoresEsperados = Object.values(mapSensor);\n\n// Buffer por timestamp no flow context\nlet buffer = flow.get(\"sensorBuffer\") || {};\n\nconst dado = msg.payload;\nconst ts = dado.timestamp;                // ISO8601/epoch conforme sua entrada\nconst nomeSensor = mapSensor[dado.sensor];\n\nif (!nomeSensor) return null; // ignora sensores desconhecidos\n\n// Cria bucket do timestamp se necessário\nif (!buffer[ts]) buffer[ts] = {};\n\n// Armazena valor padronizado\nbuffer[ts][nomeSensor] = dado.valor;\nflow.set(\"sensorBuffer\", buffer);\n\n// Verifica se todos os sensores chegaram\nconst sensoresPresentes = Object.keys(buffer[ts]);\nconst todosPresentes = sensoresEsperados.every(s => sensoresPresentes.includes(s));\n\nif (todosPresentes) {\n    // Payload final: metadados + geolocalização + timestamp + leituras\n    const payloadFinal = {\n        // --- metadados (topo) ---\n        deviceId: DEVICE_META.deviceId,\n        station: DEVICE_META.station,\n        lat: Number(DEVICE_META.lat),\n        lon: Number(DEVICE_META.lon),\n        model: DEVICE_META.model,\n        fw_version: DEVICE_META.fw_version,\n        // --- tempo ---\n        timestamp: ts\n    };\n\n    // Leituras (flatten para facilitar consumo / Grafana)\n    sensoresEsperados.forEach(s => {\n        payloadFinal[s] = buffer[ts][s] ?? null;\n    });\n\n    // Limpa o bucket do timestamp\n    delete buffer[ts];\n    flow.set(\"sensorBuffer\", buffer);\n\n    // Playload pronto para envio\n    msg.payload = payloadFinal;\n    msg.qos = 1;        // opcional\n    msg.retain = false;    // telemetria normalmente não é retida\n    return msg;\n}\n\n// Ainda aguardando outros sensores desse timestamp\nreturn null;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "// Code added here will be run once\n// whenever the node is started.\nflow.set(\"index\", 0);\nflow.set(\"buffers\", {});\n\n",
        "finalize": "",
        "libs": [],
        "x": 1480,
        "y": 440,
        "wires": [
            [
                "afbb467272a9408f",
                "32be4775d46c52f3"
            ]
        ]
    },
    {
        "id": "afbb467272a9408f",
        "type": "mqtt out",
        "z": "c1189ac503fd8176",
        "name": "MQTT Client - Publish Telemetria",
        "topic": "airq/devices/device12/telemetria",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "0027efa220a1b943",
        "x": 1760,
        "y": 440,
        "wires": []
    },
    {
        "id": "3989765cabe52947",
        "type": "json",
        "z": "c1189ac503fd8176",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 120,
        "wires": [
            [
                "831f9f992e396c3d"
            ]
        ]
    },
    {
        "id": "831f9f992e396c3d",
        "type": "split",
        "z": "c1189ac503fd8176",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 950,
        "y": 120,
        "wires": [
            [
                "57ca5407e6278b0b"
            ]
        ]
    },
    {
        "id": "57ca5407e6278b0b",
        "type": "delay",
        "z": "c1189ac503fd8176",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 120,
        "wires": [
            [
                "f1674b24453333e0"
            ]
        ]
    },
    {
        "id": "b218e66caa027091",
        "type": "inject",
        "z": "c1189ac503fd8176",
        "name": "Iniciar simulação",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 170,
        "y": 440,
        "wires": [
            [
                "2bc08ec6a2439b07",
                "5761eab5025fab85",
                "43e574170103c3a0",
                "44ea899e3cfe863a",
                "50d5fe1707452fc0",
                "465dd8a6c142672a",
                "80fc73d28cfddb92",
                "306018183ce983ee",
                "a43546fbbd5df340"
            ]
        ]
    },
    {
        "id": "a0d659cf6afd8368",
        "type": "json",
        "z": "c1189ac503fd8176",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 200,
        "wires": [
            [
                "607619fd99eed097"
            ]
        ]
    },
    {
        "id": "607619fd99eed097",
        "type": "split",
        "z": "c1189ac503fd8176",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 940,
        "y": 200,
        "wires": [
            [
                "71a614235c3728d1"
            ]
        ]
    },
    {
        "id": "71a614235c3728d1",
        "type": "delay",
        "z": "c1189ac503fd8176",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 200,
        "wires": [
            [
                "f1674b24453333e0"
            ]
        ]
    },
    {
        "id": "4c2f55ddac031e0d",
        "type": "json",
        "z": "c1189ac503fd8176",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 280,
        "wires": [
            [
                "fbe554ab3923a59c"
            ]
        ]
    },
    {
        "id": "fbe554ab3923a59c",
        "type": "split",
        "z": "c1189ac503fd8176",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 940,
        "y": 280,
        "wires": [
            [
                "9cda6fe2d1968eb2"
            ]
        ]
    },
    {
        "id": "9cda6fe2d1968eb2",
        "type": "delay",
        "z": "c1189ac503fd8176",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 280,
        "wires": [
            [
                "f1674b24453333e0"
            ]
        ]
    },
    {
        "id": "3c70292a1d9d14c5",
        "type": "json",
        "z": "c1189ac503fd8176",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 360,
        "wires": [
            [
                "fac21a49bb7ac448"
            ]
        ]
    },
    {
        "id": "fac21a49bb7ac448",
        "type": "split",
        "z": "c1189ac503fd8176",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 940,
        "y": 360,
        "wires": [
            [
                "dc9fd7180b5da943"
            ]
        ]
    },
    {
        "id": "dc9fd7180b5da943",
        "type": "delay",
        "z": "c1189ac503fd8176",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 360,
        "wires": [
            [
                "f1674b24453333e0"
            ]
        ]
    },
    {
        "id": "0162155e220969cd",
        "type": "json",
        "z": "c1189ac503fd8176",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 440,
        "wires": [
            [
                "1ba4028cdb724029"
            ]
        ]
    },
    {
        "id": "1ba4028cdb724029",
        "type": "split",
        "z": "c1189ac503fd8176",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 940,
        "y": 440,
        "wires": [
            [
                "159de29fc1113e2a"
            ]
        ]
    },
    {
        "id": "159de29fc1113e2a",
        "type": "delay",
        "z": "c1189ac503fd8176",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 440,
        "wires": [
            [
                "f1674b24453333e0"
            ]
        ]
    },
    {
        "id": "0802e33b5df26868",
        "type": "json",
        "z": "c1189ac503fd8176",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 520,
        "wires": [
            [
                "5b923c136022d55c"
            ]
        ]
    },
    {
        "id": "5b923c136022d55c",
        "type": "split",
        "z": "c1189ac503fd8176",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 940,
        "y": 520,
        "wires": [
            [
                "887f82d8ac9c109c"
            ]
        ]
    },
    {
        "id": "887f82d8ac9c109c",
        "type": "delay",
        "z": "c1189ac503fd8176",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 520,
        "wires": [
            [
                "f1674b24453333e0"
            ]
        ]
    },
    {
        "id": "eb7e0ecc71b02285",
        "type": "json",
        "z": "c1189ac503fd8176",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 600,
        "wires": [
            [
                "7d0119cbaa609c49"
            ]
        ]
    },
    {
        "id": "7d0119cbaa609c49",
        "type": "split",
        "z": "c1189ac503fd8176",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 600,
        "wires": [
            [
                "1e25572e24b6a130"
            ]
        ]
    },
    {
        "id": "1e25572e24b6a130",
        "type": "delay",
        "z": "c1189ac503fd8176",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 600,
        "wires": [
            [
                "f1674b24453333e0"
            ]
        ]
    },
    {
        "id": "dbdac21169b2bb82",
        "type": "json",
        "z": "c1189ac503fd8176",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 680,
        "wires": [
            [
                "12597d47019e75d6"
            ]
        ]
    },
    {
        "id": "12597d47019e75d6",
        "type": "split",
        "z": "c1189ac503fd8176",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 680,
        "wires": [
            [
                "62eccff5abf41b47"
            ]
        ]
    },
    {
        "id": "62eccff5abf41b47",
        "type": "delay",
        "z": "c1189ac503fd8176",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 680,
        "wires": [
            [
                "f1674b24453333e0"
            ]
        ]
    },
    {
        "id": "3bea678979e875aa",
        "type": "json",
        "z": "c1189ac503fd8176",
        "name": "Converter JSON → Array",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 730,
        "y": 760,
        "wires": [
            [
                "8680d06de525cb8f"
            ]
        ]
    },
    {
        "id": "8680d06de525cb8f",
        "type": "split",
        "z": "c1189ac503fd8176",
        "name": "Separar objetos",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 960,
        "y": 760,
        "wires": [
            [
                "e622673a64270b3a"
            ]
        ]
    },
    {
        "id": "e622673a64270b3a",
        "type": "delay",
        "z": "c1189ac503fd8176",
        "name": "Enviar a cada 60s",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 760,
        "wires": [
            [
                "f1674b24453333e0"
            ]
        ]
    },
    {
        "id": "32be4775d46c52f3",
        "type": "debug",
        "z": "c1189ac503fd8176",
        "d": true,
        "name": "Payload - device 06",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1710,
        "y": 340,
        "wires": []
    }
]