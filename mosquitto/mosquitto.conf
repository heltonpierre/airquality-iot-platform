####################################################################
# Configuração do Mosquitto Broker MQTT
# Local: /etc/mosquitto/mosquitto.conf
# Autor: Helton Medeiros
# Data: 2025-08-04
# Descrição: Configuração otimizada para simulação de IoT com MQTT
####################################################################

# =================================================================
# Listener padrão (MQTT TCP sem TLS)
# =================================================================
per_listener_settings true
listener 1883 0.0.0.0
protocol mqtt

# =================================================================
# Segurança
# =================================================================
allow_anonymous false
password_file /etc/mosquitto/mosquitto_passwd
acl_file /etc/mosquitto/acl

# =================================================================
# Persistência
# =================================================================
persistence true
persistence_location /var/lib/mosquitto/
persistence_file mosquitto.db
autosave_interval 1800
autosave_on_changes true

# =================================================================
# Logging
# =================================================================
log_dest file /var/log/mosquitto/mosquitto.log
log_type error
log_type warning
log_type notice
connection_messages true
log_timestamp true

# =================================================================
# Desempenho
# =================================================================
max_inflight_messages 50
max_queued_messages 1000
max_packet_size 262144

# =================================================================
# Sistema interno de monitoramento
# =================================================================
sys_interval 60

# =================================================================
# Diretório de configuração adicional (boa prática)
# =================================================================
include_dir /etc/mosquitto/conf.d

# =================================================================
# TLS opcional para produção (comentar se não usar)
# =================================================================
# listener 8883 0.0.0.0
# protocol mqtt
# cafile /etc/mosquitto/certs/ca.crt
# certfile /etc/mosquitto/certs/server.crt
# keyfile /etc/mosquitto/certs/server.key
# require_certificate false
# tls_version tlsv1.2